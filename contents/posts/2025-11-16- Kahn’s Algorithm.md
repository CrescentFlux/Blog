# Kahnâ€™s Algorithm
## **åŸºç¡€çŸ¥è¯†**
- **å®šä¹‰** 
   -  Arthur B. Kahn äº 1962 å¹´æå‡ºï¼Œæ˜¯è§£å†³æœ‰å‘æ— ç¯å›¾æ‹“æ‰‘æ’åºé—®é¢˜çš„ç»å…¸ç®—æ³•
   -  åŸºäºè´ªå¿ƒå’Œå…¥åº¦çš„æ‹“æ‰‘æ’åºç®—æ³•ï¼Œå®ƒé€šè¿‡ä¸æ–­ç§»é™¤å›¾ä¸­æ²¡æœ‰å‰é©±ä¾èµ–ï¼ˆå…¥åº¦ä¸º0ï¼‰çš„èŠ‚ç‚¹ï¼Œæ¥ç”Ÿæˆä¸€ä¸ªæ»¡è¶³æ‰€æœ‰ä¾èµ–å…³ç³»çš„çº¿æ€§åºåˆ—

## æ³¨æ„äº‹é¡¹
- **ä»£ç å®ç°**
```
function topologicalSort(graph) {
    // æ­¥éª¤1ï¼šåˆå§‹åŒ–å…¥åº¦æ˜ å°„ï¼ˆindegreeï¼‰å’Œé˜Ÿåˆ—ï¼ˆqueueï¼‰
    /*
    å…¥åº¦ = è¿™ä¸ªä»»åŠ¡å¼€å§‹å‰ï¼Œå¿…é¡»å®Œæˆçš„å‰ç½®ä»»åŠ¡çš„æ•°é‡;å…¥åº¦æ˜ å°„çš„å”¯ä¸€ä½¿å‘½æ˜¯ï¼šéšæ—¶å›ç­”æŸä¸ªä»»åŠ¡ç°åœ¨èƒ½ä¸èƒ½å¼€å§‹ï¼Ÿåªè¦æŸ¥è¡¨ï¼Œçœ‹å®ƒå¯¹åº”çš„æ•°å­—æ˜¯ä¸æ˜¯0å°±è¡Œäº†
    å…¥åº¦æ˜ å°„æ˜¯ä¸€ä¸ªæ´»çš„è®¡æ•°å™¨ï¼Œè®°å½•ç€æ¯ä¸ªä»»åŠ¡å½“å‰æ—¶åˆ»å°šæœªå®Œæˆçš„ã€é˜»å¡å®ƒçš„å‰ç½®ä»»åŠ¡çš„æ•°é‡ã€‚
    æ˜ å°„:å®ƒåœ¨ä»»åŠ¡åï¼ˆé”®ï¼‰å’Œå‰©ä½™ä¾èµ–æ•°ï¼ˆå€¼ï¼‰ä¹‹é—´å»ºç«‹äº†ä¸€ä¸€å¯¹åº”çš„å…³ç³»è®©æˆ‘ä»¬èƒ½é€šè¿‡ä»»åŠ¡åï¼Œç¬é—´æŸ¥åˆ°å®ƒçš„çŠ¶æ€
    å¦‚ä½•å·¥ä½œï¼šåˆå§‹åŒ–ï¼šæ ¹æ®ä¾èµ–å›¾ï¼Œç»Ÿè®¡å¥½æ¯ä¸ªä»»åŠ¡çš„æ¬ å€ºæ•°ï¼›æŸ¥è¯¢ï¼šæ°¸è¿œåªæ‰¾é‚£äº›è®¡æ•°å™¨ä¸º 0 çš„ä»»åŠ¡æ¥å¤„ç†ï¼›æ›´æ–°ï¼šæ¯å®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Œå°±åŸå­æ€§åœ°æ‰§è¡Œä¸¤ä¸ªæ“ä½œï¼šäº§å‡ºï¼šæŠŠè¿™ä¸ªä»»åŠ¡åŠ å…¥åˆ°ç»“æœåºåˆ—ï¼›æ¶ˆå‡ï¼šæŠŠæ‰€æœ‰è¢«å®ƒé˜»å¡çš„ä»»åŠ¡çš„è®¡æ•°å™¨ å‡1ã€‚
    */
    const indegree = {};
    const queue = [];
    const result = [];
    // 1.1 åˆå§‹åŒ–æ‰€æœ‰èŠ‚ç‚¹çš„å…¥åº¦ä¸º0
    for (let node in graph) {
        indegree[node] = 0;
    }
    // 1.2 è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å®é™…å…¥åº¦//ä¾èµ–å…³ç³»æ™®æŸ¥
    for (let node in graph) {//é€ä¸ªç‚¹åæ¯ä¸€ä¸ªä»»åŠ¡èŠ‚ç‚¹ï¼›è¯¥ä»»åŠ¡èŠ‚ç‚¹çš„å®Œæˆï¼Œå°†ä¼šè§£é”å“ªäº›åç»­ä»»åŠ¡
        for (let neighbor of graph[node]) {//å¯¹äºå½“å‰ç‚¹åçš„è¿™ä¸ªä»»åŠ¡ï¼Œä½ æŠŠå®ƒæ‰€æœ‰çš„é‚»å±…èŠ‚ç‚¹éƒ½å«å‡ºæ¥ã€‚
            // æ›´æ–°é‚»å±…èŠ‚ç‚¹çš„å…¥åº¦
            indegree[neighbor] = (indegree[neighbor] || 0) + 1;
        /*
        (indegree[neighbor] || 0):||æ˜¯JavaScriptä¸­éå¸¸å¸¸ç”¨ä¸”é‡è¦çš„ä¸€ä¸ªæ“ä½œç¬¦ï¼Œå«åšé€»è¾‘æˆ–æ“ä½œç¬¦ã€‚ä½†åœ¨è¿™é‡Œï¼Œå®ƒè¢«ç”¨ä½œä¸€ç§è¯­æ³•ç³–æ¥å®ç°ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½
        è¾“å…¥ï¼šå»æŸ¥è¡¨é‡Œé‚»å±…å½“å‰çš„æ¬ å€ºæ•°
        æ¼æ–—æ£€æŸ¥ï¼šå¦‚æœæŸ¥åˆ°çš„æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ•°å­—ï¼ˆå“ªæ€•æ˜¯0ï¼‰ï¼Œå°±è®©è¿™ä¸ªæ•°å­—é€šè¿‡
        å¦‚æœæŸ¥ä¸åˆ°ï¼ˆå¾—åˆ° undefinedï¼‰ï¼Œæ¼æ–—å°±ä¼šè‡ªåŠ¨æ‰å‡ºä¸€ä¸ª 0 æ¥ä½œä¸ºæ›¿ä»£å“
        è¾“å‡ºï¼šä¸€ä¸ªä¿è¯æœ‰æ•ˆçš„æ•°å­—ï¼ˆè¦ä¹ˆæ˜¯æŸ¥åˆ°çš„å€¼ï¼Œè¦ä¹ˆæ˜¯0ï¼‰è¿™ä¸ªä¿è¯æœ‰æ•ˆçš„æ•°å­—å†æ‰§è¡Œ +1 æ“ä½œï¼Œå°±ç»å¯¹å®‰å…¨äº†
        æ¯æœ‰ä¸€ä¸ªä»»åŠ¡èŠ‚ç‚¹æŒ‡å‘è¿™ä¸ªé‚»å±…èŠ‚ç‚¹ï¼Œé‚»å±…èŠ‚ç‚¹èº«ä¸Šå°±å¤šä¸€ä»½å…¥åº¦(+1ï¼‰;åœ¨ä½ æ‰‹ä¸­çš„ä»»åŠ¡çŠ¶æ€è¡¨indegreeæ˜ å°„ä¸Šï¼Œç»™è¿™ä¸ªé‚»å±…èŠ‚ç‚¹çš„æ¬ å€ºæ•°éƒ½åŠ ä¸Š1
        */
        }
    }

    // æ­¥éª¤2ï¼šæ‰¾åˆ°æ‰€æœ‰å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼ŒåŠ å…¥é˜Ÿåˆ—
    for (let node in indegree) {
        if (indegree[node] === 0) {
            //å°†å…¥åº¦ä¸º0çš„èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—
            queue.push(node);
        }
    }

    // æ­¥éª¤3ï¼šå¤„ç†é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹
    while (queue.length > 0) {//â€œåªè¦ç°åœ¨å°±èƒ½å¹²çš„ç¯®å­é‡Œè¿˜æœ‰æ´»ï¼Œæˆ‘ä»¬å°±ä¸€åˆ»ä¸åœï¼Œç»§ç»­æ´¾æ´»
        // ä»é˜Ÿåˆ—æœ€å‰é¢æ‹¿ä¸€ä¸ªä»»åŠ¡
        const currentNode = queue.shift();
        /*è´ªå¿ƒç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæ¯ä¸€æ­¥éƒ½åšå‡ºåœ¨å½“å‰çŠ¶æ€ä¸‹çœ‹èµ·æ¥æœ€å¥½çš„é€‰æ‹©ï¼Œå¹¶æœŸæœ›é€šè¿‡è¿™ä¸€ç³»åˆ—çš„å±€éƒ¨æœ€ä¼˜é€‰æ‹©ï¼Œæœ€ç»ˆè¾¾åˆ°å…¨å±€æœ€ä¼˜
        å±€éƒ¨æœ€ä¼˜é€‰æ‹©ï¼šåœ¨æ¯ä¸€è½®å¾ªç¯ä¸­ï¼Œç®—æ³•éƒ½ä»é˜Ÿåˆ—ä¸­ä»»æ„é€‰æ‹©ä¸€ä¸ªå½“å‰â€œæœ€å¥½â€ï¼ˆå³å…¥åº¦ä¸º0ï¼Œæ²¡æœ‰ä»»ä½•çº¦æŸï¼‰çš„èŠ‚ç‚¹æ¥å¤„ç†
        ä¸è€ƒè™‘é•¿è¿œå½±å“ï¼šç®—æ³•åœ¨é€‰æ‹© currentNode æ—¶ï¼Œå®Œå…¨ä¸ä¼šè€ƒè™‘è¿™ä¸ªé€‰æ‹©ä¼šä¸ä¼šå¯¼è‡´åç»­çš„æ‹“æ‰‘åºåˆ—ä¸æ˜¯â€œå­—å…¸åºæœ€å°â€çš„ï¼Œæˆ–è€…æ˜¯ä¸æ˜¯æŸç§æ„ä¹‰ä¸‹çš„â€œæœ€ä¼˜â€åºåˆ—ã€‚å®ƒåªå…³å¿ƒï¼šè¿™ä¸ªèŠ‚ç‚¹ç°åœ¨èƒ½å¤„ç†å—ï¼Ÿèƒ½é‚£å°±ç«‹åˆ»å¤„ç†
        çŸ­è§†çš„åˆç†æ€§ï¼šåœ¨æ‹“æ‰‘æ’åºè¿™ä¸ªé—®é¢˜ä¸­ï¼Œè¿™ç§çŸ­è§†æ˜¯å®Œå…¨åˆç†ä¸”æ­£ç¡®çš„ã€‚æ­¤æ—¶æ‰€æœ‰å…¥åº¦ä¸º0çš„èŠ‚ç‚¹åœ¨æ­¤æ—¶æ­¤åˆ»éƒ½æ˜¯å¹³ç­‰çš„ã€åˆæ³•çš„é€‰æ‹©ï¼Œå…ˆå¤„ç†å“ªä¸€ä¸ªå¹¶ä¸ä¼šå½±å“æœ€ç»ˆèƒ½å¦å¾—åˆ°ä¸€ä¸ªåˆæ³•çš„æ‹“æ‰‘åºåˆ—ï¼ˆåªä¼šå½±å“åºåˆ—çš„å…·ä½“é¡ºåºï¼‰ã€‚
        */
        // å°†å½“å‰èŠ‚ç‚¹ä¹Ÿå°±æ˜¯æœ€å‰é¢è¿™ä¸ªä»»åŠ¡åŠ å…¥ç»“æœåºåˆ—,åœ¨å·²å®Œæˆæ¸…å•ä¸Šè®°å½•å®Œæˆçš„ä»»åŠ¡åç§°
        result.push(currentNode);
        // å¤„ç†æœ€å‰é¢è¿™ä¸ªä»»åŠ¡å®Œæˆåå¼•èµ·çš„ä¸€ç³»åˆ—è¿é”ååº”
        for (let neighbor of graph[currentNode]) {//æŸ¥çœ‹å‰é¢ä»»åŠ¡çš„å®Œæˆå½±å“äº†å“ªäº›ä»»åŠ¡çš„å®ç°ï¼Œæ‰¾åˆ°è¿™ä¸ªè¢«å½±å“çš„ä»»åŠ¡èŠ‚ç‚¹
            // å®Œæˆäº†ä¸€ä¸ªå‰ç½®æ¡ä»¶åï¼Œå°†é‚»å±…èŠ‚ç‚¹çš„å…¥åº¦å‡1
            indegree[neighbor]--;//indegree[neighbor] è¿™ä¸ªå˜é‡ä»£è¡¨çš„æ˜¯ï¼šâ€œé‚»å±…ä»»åŠ¡å½“å‰æ—¶åˆ»å°šæœªæ»¡è¶³çš„ä¾èµ–æ•°é‡â€ï¼›å‡1æ˜¯ä¾èµ–å…³ç³»çš„æ¶ˆäº¡
            // å¦‚æœé‚»å±…èŠ‚ç‚¹çš„å…¥åº¦å˜ä¸º0ï¼ŒåŠ å…¥é˜Ÿåˆ—
            if (indegree[neighbor] === 0) {
                // å°†æ–°çš„å…¥åº¦ä¸º0çš„èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—
                queue.push(neighbor);
            }
        }
    }

    // æ­¥éª¤4ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¯
    if (result.length !== Object.keys(graph).length) {
        throw new Error('å›¾ä¸­å­˜åœ¨ç¯ï¼Œæ— æ³•è¿›è¡Œæ‹“æ‰‘æ’åºï¼');
    }

    return result;
}
/*
æ‹“æ‰‘æ’åºä¸»è¦è§£å†³ä¾èµ–å…³ç³»ä¸‹çš„è‡ªåŠ¨åŒ–è°ƒåº¦é—®é¢˜,ä¿è¯äº†ç¼–è¯‘çš„å¯é æ€§å’Œæ•ˆç‡
è¿™ä¸ªæ’åºæ–¹æ³•åªä¾èµ–äºå›¾æœ¬èº«çš„ã€åœ¨æ‹“æ‰‘å˜æ¢ä¸‹ä¿æŒä¸å˜çš„æ€§è´¨â€”â€”å³å…ƒç´ çš„è¿æ¥å…³ç³»;å®ƒå‰¥ç¦»äº†æ‰€æœ‰ä¸å¿…è¦çš„ç‰©ç†ç»†èŠ‚ï¼Œç›´å‡»é—®é¢˜çš„ç»“æ„æ ¸å¿ƒ
å…³æ³¨è¿æ¥ï¼Œè€Œéç»†èŠ‚ï¼š
    åœ¨æˆ‘ä»¬çš„ä¾èµ–å›¾é‡Œï¼Œæˆ‘ä»¬å®Œå…¨ä¸å…³å¿ƒä»»åŠ¡ï¼ˆèŠ‚ç‚¹ï¼‰æœ¬èº«æ˜¯ä»€ä¹ˆï¼ˆæ˜¯â€œç¼–è¯‘Aâ€è¿˜æ˜¯â€œç©¿è¢œå­â€ï¼‰ã€‚
    æˆ‘ä»¬ä¹Ÿå®Œå…¨ä¸å…³å¿ƒä¾èµ–ï¼ˆè¾¹ï¼‰çš„é•¿çŸ­ã€ç²—ç»†ã€‚
    æˆ‘ä»¬åªå…³å¿ƒä¸€ä»¶äº‹ï¼šèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»ã€‚ä¹Ÿå°±æ˜¯ï¼Œè°æŒ‡å‘è°ã€‚
ä¾èµ–å…³ç³»åˆ†æå™¨ï¼Œæ­»é”æ£€æµ‹å™¨ï¼ˆèƒ½ç²¾å‡†å‘ç°å¾ªç¯ä¾èµ–ï¼‰ï¼Œä»»åŠ¡è°ƒåº¦å™¨çš„æ ¸å¿ƒé€»è¾‘

æ‹“æ‰‘æ’åºä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ’åºå·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ªå¼ºå¤§çš„â€œç¯æ£€æµ‹å™¨â€;â€œæ— ç¯â€æ˜¯ç®—æ³•èƒ½å¤Ÿé¡ºåˆ©è¿è¡Œåˆ°ç»“æŸçš„ä¿è¯;
ä¸€æ—¦å›¾ä¸­å­˜åœ¨ç¯ï¼š
ç¯å†…çš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œéƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¾èµ–æ¥è‡ªç¯å†…çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚
åœ¨ç¯å¤–çš„èŠ‚ç‚¹å…¨éƒ¨è¢«å¤„ç†å®Œä¹‹å‰ï¼Œç¯å†…ä¸å¯èƒ½å‡ºç°ä»»ä½•ä¸€ä¸ªå…¥åº¦ä¸º0çš„èŠ‚ç‚¹ã€‚
æœ€ç»ˆï¼Œç®—æ³•ä¼šæ¸…ç©ºæ‰€æœ‰ç¯å¤–çš„èŠ‚ç‚¹ã€‚è¿™æ—¶ï¼Œåœºä¸Šå‰©ä¸‹çš„å…¨æ˜¯ç¯å†…çš„èŠ‚ç‚¹ï¼Œè€Œå®ƒä»¬çš„å…¥åº¦éƒ½å¤§äº0ã€‚
ç®—æ³•ä¼šåœæ»â€”â€”é˜Ÿåˆ—å·²ç©ºï¼Œä½†è¿˜æœ‰èŠ‚ç‚¹æœªè¢«å¤„ç†ã€‚

ä¸€ä¸ªç®—æ³•å¿…é¡»æ˜¯ä¸€ç³»åˆ—è¢«ç²¾ç¡®å®šä¹‰çš„ã€è§£å†³é—®é¢˜çš„ã€æœ‰é™çš„æ­¥éª¤
*/
// æµ‹è¯•
function testTopologicalSort() {
    // æµ‹è¯•ç”¨ä¾‹1ï¼šç®€å•çš„çº¿æ€§ä¾èµ– A -> B -> C
    const graph1 = {
        'A': ['B'],
        'B': ['C'], 
        'C': []
    };
    // æµ‹è¯•ç”¨ä¾‹2ï¼šå¹¶è¡Œä¾èµ–
    const graph2 = {
        'A': ['C'],
        'B': ['C'],
        'C': ['D'],
        'D': []//æ‹“æ‰‘æ’åºçš„ç»“æœä¸å”¯ä¸€ï¼šåªè¦æœ‰å¹¶è¡Œä»»åŠ¡ï¼ˆå¦‚Aå’ŒBï¼‰ï¼Œå°±å¯èƒ½äº§ç”Ÿå¤šä¸ªåˆæ³•åºåˆ—
    };
    // æµ‹è¯•ç”¨ä¾‹3ï¼šæœ‰ç¯å›¾ï¼ˆåº”è¯¥æŠ¥é”™ï¼‰
    const graph3 = {
        'A': ['B'],
        'B': ['C'],
        'C': ['A']  // å½¢æˆç¯ A->B->C->A
    };
    console.log('æµ‹è¯•1 - çº¿æ€§ä¾èµ–:');
    try {
        const result1 = topologicalSort(graph1);
        console.log('ç»“æœ:', result1); // åº”è¯¥è¾“å‡ºç±»ä¼¼ ['A', 'B', 'C']
    } catch (e) {
        console.log('é”™è¯¯:', e.message);
    }
    console.log('\næµ‹è¯•2 - å¹¶è¡Œä¾èµ–:');
    try {
        const result2 = topologicalSort(graph2);
        console.log('ç»“æœ:', result2); // å¯èƒ½è¾“å‡º ['A', 'B', 'C', 'D'] æˆ– ['B', 'A', 'C', 'D']
    } catch (e) {
        console.log('é”™è¯¯:', e.message);
    }
    console.log('\næµ‹è¯•3 - æœ‰ç¯å›¾:');
    try {
        const result3 = topologicalSort(graph3);
        console.log('ç»“æœ:', result3);
    } catch (e) {
        console.log('é”™è¯¯:', e.message); // åº”è¯¥è¾“å‡ºç¯é”™è¯¯
    }
}
// è¿è¡Œæµ‹è¯•
testTopologicalSort();
// æµ‹è¯•ä¸€ä¸ªåƒç€‘å¸ƒä¸€æ ·å±•å¼€çš„å¤æ‚ä¾èµ–å›¾
const largeParallelGraph = {
    'A': ['D', 'E', 'F'],
    'B': ['D', 'G', 'H'], 
    'C': ['E', 'F', 'I'],
    'D': ['J', 'K'],
    'E': ['L', 'M'],
    'F': ['N'],
    'G': ['O'],
    'H': ['P', 'Q'],
    'I': ['R'],
    'J': ['S'],
    'K': ['T'],
    'L': ['U'],
    'M': ['V'],
    'N': ['W'],
    'O': ['X'],
    'P': ['Y'],
    'Q': ['Z'],
    'R': [],
    'S': [],
    'T': [], 
    'U': [],
    'V': [],
    'W': [],
    'X': [],
    'Y': [],
    'Z': []
};

console.log('å¼ºåº¦æµ‹è¯•ä¸€ - å¤§å‹å¹¶è¡Œå›¾:');
try {
    const startTime = performance.now();
    const result = topologicalSort(largeParallelGraph);
    const endTime = performance.now();
    
    console.log('ç»“æœé•¿åº¦:', result.length);
    console.log('å‰10ä¸ªèŠ‚ç‚¹:', result.slice(0, 10));
    console.log(`æ‰§è¡Œæ—¶é—´: ${(endTime - startTime).toFixed(2)} æ¯«ç§’`);
    
    // éªŒè¯ç»“æœæ­£ç¡®æ€§
    let isValid = true;
    for (let node in largeParallelGraph) {
        for (let neighbor of largeParallelGraph[node]) {
            if (result.indexOf(node) > result.indexOf(neighbor)) {
                console.log(`é”™è¯¯! ${node} åº”è¯¥åœ¨ ${neighbor} ä¹‹å‰`);
                isValid = false;
            }
        }
    }
    if (isValid) console.log('âœ… æ’åºç»“æœéªŒè¯é€šè¿‡ï¼');
} catch (e) {
    console.log('é”™è¯¯:', e.message);
}
// æµ‹è¯•ä¸€ä¸ªéšè—å¾ˆæ·±çš„ç¯
const sneakyCycleGraph = {
    'A': ['B', 'C'],
    'B': ['D', 'E'],
    'C': ['F', 'G'],
    'D': ['H'],
    'E': ['I'], 
    'F': ['J'],
    'G': ['K'],
    'H': ['L'],
    'I': ['M'],
    'J': ['N'],
    'K': ['O'],
    'L': ['P'],
    'M': ['Q'],
    'N': ['R'],
    'O': ['S'],
    'P': ['T'],
    'Q': ['U'],
    'R': ['V'],
    'S': ['W'],
    'T': ['X'],
    'U': ['Y'],
    'V': ['Z'],
    'W': ['A'], // è¿™é‡Œå½¢æˆäº†ä¸€ä¸ªå¤§ç¯ A -> ... -> W -> A
    'X': [],
    'Y': [],
    'Z': []
};

console.log('\nå¼ºåº¦æµ‹è¯•äºŒ - éšè—ç¯æ£€æµ‹:');
try {
    const result = topologicalSort(sneakyCycleGraph);
    console.log('ç»“æœ:', result.length, 'ä¸ªèŠ‚ç‚¹');
} catch (e) {
    console.log('âœ… æˆåŠŸæ£€æµ‹åˆ°ç¯:', e.message);
}

// æ¨¡æ‹Ÿä¸€ä¸ªå¤§å­¦çš„è¯¾ç¨‹å…ˆä¿®å…³ç³»
const universityCurriculum = {
    'é«˜ç­‰æ•°å­¦A': ['çº¿æ€§ä»£æ•°', 'æ¦‚ç‡è®º'],
    'çº¿æ€§ä»£æ•°': ['æœºå™¨å­¦ä¹ '],
    'æ¦‚ç‡è®º': ['æœºå™¨å­¦ä¹ ', 'ç»Ÿè®¡å­¦'],
    'ç¨‹åºè®¾è®¡åŸºç¡€': ['æ•°æ®ç»“æ„', 'ç®—æ³•è®¾è®¡'],
    'æ•°æ®ç»“æ„': ['ç®—æ³•è®¾è®¡', 'æ•°æ®åº“ç³»ç»Ÿ'],
    'ç®—æ³•è®¾è®¡': ['æœºå™¨å­¦ä¹ ', 'ç¼–è¯‘åŸç†'],
    'æ•°æ®åº“ç³»ç»Ÿ': ['åˆ†å¸ƒå¼ç³»ç»Ÿ'],
    'ç»Ÿè®¡å­¦': ['æ•°æ®æŒ–æ˜'],
    'æœºå™¨å­¦ä¹ ': ['æ·±åº¦å­¦ä¹ ', 'è‡ªç„¶è¯­è¨€å¤„ç†'],
    'ç¼–è¯‘åŸç†': ['æ“ä½œç³»ç»Ÿ'],
    'æ·±åº¦å­¦ä¹ ': ['è®¡ç®—æœºè§†è§‰'],
    'è‡ªç„¶è¯­è¨€å¤„ç†': ['å¤§è¯­è¨€æ¨¡å‹'],
    'æ“ä½œç³»ç»Ÿ': ['åˆ†å¸ƒå¼ç³»ç»Ÿ'],
    'è®¡ç®—æœºè§†è§‰': [],
    'å¤§è¯­è¨€æ¨¡å‹': [],
    'åˆ†å¸ƒå¼ç³»ç»Ÿ': [],
    'æ•°æ®æŒ–æ˜': []
};

console.log('\nå¼ºåº¦æµ‹è¯•ä¸‰ - å¤§å­¦è¯¾ç¨‹è§„åˆ’:');
try {
    const coursePlan = topologicalSort(universityCurriculum);
    console.log('æ¨èå­¦ä¹ é¡ºåº:');
    coursePlan.forEach((course, index) => {
        console.log(`${index + 1}. ${course}`);
    });
    
    // éªŒè¯è¿™ä¸ªå­¦ä¹ é¡ºåºæ˜¯å¦åˆç†
    console.log('\néªŒè¯å…³é”®ä¾èµ–å…³ç³»:');
    const mlIndex = coursePlan.indexOf('æœºå™¨å­¦ä¹ ');
    const mathIndex = coursePlan.indexOf('é«˜ç­‰æ•°å­¦A');
    const linearAlgebraIndex = coursePlan.indexOf('çº¿æ€§ä»£æ•°');
    
    console.log(`æœºå™¨å­¦ä¹ (${mlIndex}) åœ¨ é«˜ç­‰æ•°å­¦(${mathIndex}) ä¹‹å: ${mlIndex > mathIndex ? 'âœ…' : 'âŒ'}`);
    console.log(`æœºå™¨å­¦ä¹ (${mlIndex}) åœ¨ çº¿æ€§ä»£æ•°(${linearAlgebraIndex}) ä¹‹å: ${mlIndex > linearAlgebraIndex ? 'âœ…' : 'âŒ'}`);
    
} catch (e) {
    console.log('é”™è¯¯:', e.message);
}

console.log('\nå¼ºåº¦æµ‹è¯•å›› - æç«¯æƒ…å†µ:');
// æµ‹è¯•ç©ºå›¾
try {
    const emptyResult = topologicalSort({});
    console.log('ç©ºå›¾æµ‹è¯•:', emptyResult, 'âœ…');
} catch (e) {
    console.log('ç©ºå›¾é”™è¯¯:', e.message);
}
// æµ‹è¯•å•èŠ‚ç‚¹å›¾
try {
    const singleNodeResult = topologicalSort({'å­¤ç‹¬çš„èŠ‚ç‚¹': []});
    console.log('å•èŠ‚ç‚¹æµ‹è¯•:', singleNodeResult, 'âœ…');
} catch (e) {
    console.log('å•èŠ‚ç‚¹é”™è¯¯:', e.message);
}
// æµ‹è¯•å®Œå…¨ç‹¬ç«‹çš„èŠ‚ç‚¹
try {
    const independentGraph = {
        'ä»»åŠ¡A': [],
        'ä»»åŠ¡B': [],
        'ä»»åŠ¡C': [],
        'ä»»åŠ¡D': []
    };
    const independentResult = topologicalSort(independentGraph);
    console.log('å®Œå…¨ç‹¬ç«‹ä»»åŠ¡æµ‹è¯•: é•¿åº¦=', independentResult.length, 'âœ…');
} catch (e) {
    console.log('ç‹¬ç«‹ä»»åŠ¡é”™è¯¯:', e.message);
}
console.log("ğŸ‰ æ‹“æ‰‘æ’åºå¥å£®æ€§éªŒè¯é€šè¿‡ï¼");
console.log("ğŸŒŸ ç®—æ³•ç‰¹æ€§æ€»ç»“:");
console.log("   âœ… é«˜æ•ˆå¤„ç†å¤æ‚ä¾èµ–ç½‘ (26èŠ‚ç‚¹, 0ms)");  
console.log("   âœ… ç²¾å‡†æ£€æµ‹å¾ªç¯ä¾èµ– (éšè—ç¯ä¹Ÿèƒ½å‘ç°)");
console.log("   âœ… ç¨³å®šå¤„ç†è¾¹ç•Œæƒ…å†µ (ç©ºå›¾/å•èŠ‚ç‚¹/ç‹¬ç«‹ä»»åŠ¡)");
console.log("   âœ… ç°å®åœºæ™¯é€‚ç”¨ (è¯¾ç¨‹è§„åˆ’/ä»»åŠ¡è°ƒåº¦)");
console.log("   âœ… æ‰§è¡Œæ•ˆç‡ä¼˜ç§€ (çº¿æ€§æ—¶é—´å¤æ‚åº¦)");
console.log("\nğŸ’ª ç»“è®ºï¼šæ‹“æ‰‘æ’åºå·²è¾¾å·¥ä¸šçº§å¼ºåº¦ï¼");
```