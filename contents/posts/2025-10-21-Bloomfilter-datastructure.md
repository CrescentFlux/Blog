# Bloomfilter
## åŸºç¡€çŸ¥è¯†
- **å®šä¹‰**
```
å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªæ¦‚ç‡å‹æ•°æ®ç»“æ„ï¼Œå®ƒç”¨æå°çš„å†…å­˜ä»£ä»·å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºæŸä¸ªé›†åˆä¸­ï¼Œç‰¹ç‚¹æ˜¯å¦å®šç­”æ¡ˆç»å¯¹å‡†ç¡®ï¼Œè‚¯å®šç­”æ¡ˆå¯èƒ½è¯¯æŠ¥ã€‚å·¥ç¨‹è§†è§’ï¼šå¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªåœ¨ç”Ÿäº§ç³»ç»Ÿä¸­ç”¨äºå‰ç½®è¿‡æ»¤çš„ç»„ä»¶ã€‚
```
- **ç‰¹æ€§**
    - å‡é˜´æ€§ç‡ï¼š0%ï¼ˆç»ä¸æ¼åˆ¤å·²å­˜åœ¨çš„å…ƒç´ ï¼‰

    - å‡é˜³æ€§ç‡ï¼š> 0%ï¼ˆå¯èƒ½è¯¯åˆ¤ä¸å­˜åœ¨çš„å…ƒç´ ï¼‰

    - ç©ºé—´å¤æ‚åº¦ï¼šO(m)ï¼Œä¸å…ƒç´ æ•°é‡æ— å…³

    - ä¸æ”¯æŒåˆ é™¤ï¼šä½å…±äº«ç‰¹æ€§

- **æ ¸å¿ƒä¸‰è¦ç´ **

|ç»„ä»¶	|ä½œç”¨	|
---|---
|æ¯”ç‰¹æ•°ç»„|	è®°å½•å…ƒç´ å­˜åœ¨ç—•è¿¹	|
|å¤šä¸ªå“ˆå¸Œå‡½æ•°	|è®¡ç®—å…ƒç´ å­˜å‚¨ä½ç½®	|
|æ“ä½œè§„åˆ™|	æ·»åŠ å’ŒæŸ¥è¯¢çš„ç®—æ³•|


## æ³¨æ„äº‹é¡¹
1. **æ··æ·†ç‚¹**
- **æ ¸å¿ƒæ¦‚å¿µ**

|ä¼ ç»Ÿå“ˆå¸Œè¡¨	|å¸ƒéš†è¿‡æ»¤å™¨|	å…³é”®ç†è§£|
---|---|---
|å­˜å‚¨å†…å®¹|	å­˜å‚¨å®Œæ•´æ•°æ®|	åªå­˜å‚¨"å­˜åœ¨æŒ‡çº¹"|	å¸ƒéš†è¿‡æ»¤å™¨ä¸å­˜æ•°æ®æœ¬èº«ï¼Œåªå­˜å­˜åœ¨è¯æ®|
|å†…å­˜å ç”¨|	å­˜å‚¨æ‰€æœ‰æ•°æ®ï¼Œå ç”¨å¤§|	åªå­˜æ¯”ç‰¹ä½ï¼Œæå°å†…å­˜|	ç”¨ç©ºé—´æ¢ç²¾åº¦çš„ç»å…¸æƒè¡¡|
|æŸ¥è¯¢ç»“æœ|	ç»å¯¹å‡†ç¡®ï¼ˆå­˜åœ¨/ä¸å­˜åœ¨ï¼‰	|æ¦‚ç‡æ€§ï¼ˆå¯èƒ½å­˜åœ¨/è‚¯å®šä¸å­˜åœ¨ï¼‰	|"å¦å®š"ç»å¯¹å¯é ï¼Œ"è‚¯å®š"å¯èƒ½è¯¯åˆ¤|

- **æŠ€æœ¯å®ç°**

|æ··æ·†ç‚¹	|ç®€æ˜“ç‰ˆæœ¬	|å·¥ç¨‹åŒ–ç‰ˆæœ¬	|å‡çº§ä»·å€¼|
---|---|---|---
|å“ˆå¸Œå‡½æ•°|	ç®€å•åŠ æƒæ±‚å’Œ|	MurmurHashç­‰å·¥ä¸šçº§å“ˆå¸Œ|	æ›´å¥½çš„åˆ†å¸ƒå‡åŒ€æ€§ï¼Œå‡å°‘å†²çª|
|ä½å­˜å‚¨|	Array(0/1) |æµªè´¹å†…å­˜	Uint8Array + ä½è¿ç®—|	8å€å†…å­˜ä¼˜åŒ–ï¼ŒçœŸå®ä½æ“ä½œ|
|å‚æ•°é…ç½®|	æ‰‹åŠ¨çŒœæµ‹ size, k	|å…¬å¼è‡ªåŠ¨è®¡ç®—|	åŸºäºæ¦‚ç‡è®ºçš„æœ€ä¼˜è§£|

- **å·¥ç¨‹åŒ–åŠŸèƒ½**

|æ··æ·†ç‚¹	|åŸºç¡€åŠŸèƒ½	|å·¥ç¨‹åŒ–å¢å¼º	|ç”Ÿäº§ä»·å€¼|
---|---|---|---
|çŠ¶æ€æŒä¹…åŒ–|	å†…å­˜ä¸­ï¼Œé‡å¯ä¸¢å¤±|	åºåˆ—åŒ–/ååºåˆ—åŒ–|	çŠ¶æ€ä¿å­˜å’Œæ•°æ®æ¢å¤|
|ç³»ç»Ÿç›‘æ§	|æ‰‹åŠ¨console.log	|å®æ—¶ç›‘æ§é¢æ¿|	å¯è§†åŒ–ç³»ç»Ÿå¥åº·åº¦|
|æ€§èƒ½ä¼˜åŒ–|	åŸºç¡€ç®—æ³•|	å†…å­˜ä¼˜åŒ– + æ€§èƒ½ç»Ÿè®¡|	å¯åº¦é‡çš„ç³»ç»Ÿæ€§èƒ½|




2. ä»£ç å®ç°
```
class BloomFilter {
   constructor(size, hashFunctions) {//æ„é€ å‡½æ•°
    // åˆå§‹åŒ–æ¯”ç‰¹æ•°ç»„
    // æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé•¿åº¦ä¸º `size` çš„æ•°ç»„ï¼Œåˆå§‹å€¼å…¨éƒ¨ä¸º 0,ç”¨æ¥æ¨¡æ‹Ÿæ¯”ç‰¹æ•°ç»„çš„æ•°æ®ç»“æ„,æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªæ¯”ç‰¹
    this.bitArray = new Array(size).fill(0);//this.bitArray æ˜¯æˆ‘ä»¬çš„â€œä½å›¾â€ï¼Œåˆå§‹æ—¶æ‰€æœ‰ä½éƒ½æ˜¯0ï¼ˆfalseï¼‰
    //his.hashFunctions å’Œ this.size æ˜¯é…ç½®å‚æ•°ï¼Œå†³å®šäº†è¿‡æ»¤å™¨çš„å‡†ç¡®æ€§å’Œå®¹é‡
    // è®°å½•å“ˆå¸Œå‡½æ•°çš„æ•°é‡
    this.hashFunctions = hashFunctions;
    
    //size: æ¯”ç‰¹æ•°ç»„çš„å¤§å°
    this.size = size;
  }

  // å®ç°ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ç”Ÿæˆå™¨
  // ç›®æ ‡: æ ¹æ®ä¸åŒçš„ç§å­ï¼Œç”Ÿæˆä¸åŒçš„å“ˆå¸Œå‡½æ•°
  /*
  æˆ‘ä»¬é€šè¿‡ä¼ å…¥ä¸åŒçš„ seed æ¥æ¨¡æ‹Ÿä¸åŒçš„å“ˆå¸Œå‡½æ•°,seed ç¡®ä¿äº†ä¸åŒå‡½æ•°çš„ä¸åŒè¾“å‡º
  */
  _hashFunction(seed) {
    return (str) => {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        // è®¡ç®—å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼
        // ä½¿ç”¨å­—ç¬¦ç¼–ç ï¼Œå¹¶ä¹˜ä»¥ç§å­ä½¿å…¶ç»“æœä¸åŒ
        hash = (hash + str.charCodeAt(i) * seed) % this.size;//å°†ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ï¼ˆstrï¼‰æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šçš„èŒƒå›´ï¼ˆ0 åˆ° this.size - 1ï¼‰å†…
        /*
        str.charCodeAt(i)è·å–å­—ç¬¦ä¸²ä¸­ç¬¬ i ä¸ªå­—ç¬¦çš„ Unicode ç¼–ç ï¼ˆä¸€ä¸ªæ•´æ•°ï¼‰
        str.charCodeAt(i) * seedï¼šå°†å­—ç¬¦ç¼–ç ä¹˜ä»¥ä¸€ä¸ªç§å­ï¼Œè®©åŒä¸€ä¸ªå­—ç¬¦åœ¨ä¸åŒå“ˆå¸Œå‡½æ•°ä¸­äº§ç”Ÿä¸åŒçš„è´¡çŒ®ã€‚
        å¦‚æœæ²¡æœ‰ seedï¼Œå­—ç¬¦ 'a' åœ¨ä»»ä½•å‡½æ•°é‡Œéƒ½åªè´¡çŒ® 97ï¼Œå‡½æ•°ä¹‹é—´å°±ç¼ºä¹ç‹¬ç«‹æ€§ã€‚seed æ”¾å¤§äº†è¿™ç§å·®å¼‚
        hash + ...ï¼šç´¯åŠ ã€‚å°†å½“å‰å­—ç¬¦çš„ï¼ˆåŠ æƒåï¼‰ç¼–ç å€¼ï¼ŒåŠ åˆ°ä¹‹å‰æ‰€æœ‰å­—ç¬¦è®¡ç®—å‡ºçš„ä¸´æ—¶hashå€¼ä¸Šï¼Œå­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½åœ¨å½±å“æœ€ç»ˆçš„å“ˆå¸Œå€¼
        ... % this.sizeï¼šå–æ¨¡è¿ç®—ã€‚è¿™æ˜¯å°†ä¸æ–­å¢å¤§çš„ï¼ˆhashå€¼ï¼‰çº¦æŸåˆ°æˆ‘ä»¬æƒ³è¦çš„èŒƒå›´å†… [0, this.size-1]ã€‚
        é˜²æ­¢ hash å€¼å˜å¾—è¿‡å¤§è€Œæº¢å‡ºã€‚åœ¨æ¯ä¸€æ­¥éƒ½å–æ¨¡ï¼Œå¯ä»¥ä¿è¯æ•°å€¼å§‹ç»ˆå¯æ§ã€‚
        ä¸åŒé¡ºåºçš„å­—ç¬¦ä¸² æœ‰æ›´é«˜æ¦‚ç‡äº§ç”Ÿä¸åŒç»“æœï¼šä¸åŒç§å­ ä¼šäº§ç”Ÿå®Œå…¨ä¸åŒçš„æƒé‡åºåˆ—ï¼Œä»è€Œæ¨¡æ‹Ÿå‡ºä¸åŒçš„å“ˆå¸Œå‡½æ•°
        */
      }
      // ç¡®ä¿è¿”å›å€¼åœ¨æ•°ç»„ç´¢å¼•èŒƒå›´å†…,% this.sizeç¡®ä¿æœ€ç»ˆçš„å“ˆå¸Œå€¼è½åœ¨[0, size-1]çš„èŒƒå›´å†…ï¼Œå¯¹åº”æˆ‘ä»¬çš„æ•°ç»„ç´¢å¼•
      return Math.abs(hash % this.size);
    };
  }
   add(item) {
    //éå†æ¯ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œé€šè¿‡æ”¹å˜ä¸€ä¸ªå‚æ•°ï¼ˆseedï¼‰ï¼Œå°±è½»æ¾åœ°åˆ›å»ºå‡ºå¤šä¸ªè¡Œä¸ºå„å¼‚çš„å“ˆå¸Œå‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯¹äºåŒä¸€ä¸ªè¾“å…¥ï¼Œä¼šäº§ç”Ÿä¸åŒçš„è¾“å‡ºï¼Œä»è€Œæ¨¡æ‹Ÿäº†å¤šä¸ªç‹¬ç«‹å“ˆå¸Œå‡½æ•°çš„å·¥ä½œæ–¹å¼
    for (let i = 0; i < this.hashFunctions; i++) {//å¾ªç¯çš„æ¯ä¸€è½®ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„éƒ½æ˜¯ä¸€ä¸ªæ–°çš„ã€ç‹¬ç«‹çš„å“ˆå¸Œå‡½æ•°
      //è·å–ç¬¬ i ä¸ªå“ˆå¸Œå‡½æ•°
      //ä½¿ç”¨æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„ _hashFunction æ–¹æ³•ï¼Œä¼ å…¥ i ä½œä¸ºç§å­
      const hashFunc = this._hashFunction(i);
      //è®¡ç®—å…ƒç´ åº”è®¾ç½®çš„ä½çš„ä½ç½®
      const position = hashFunc(item);// ç”¨è¿™ä¸ªæ–°é€ çš„å‡½æ•°è®¡ç®—ä½ç½®
      //å°†æ¯”ç‰¹æ•°ç»„ä¸­å¯¹åº”çš„ä½ç½®è®¾ç½®ä¸º1
      this.bitArray[position] = 1;}}//å½“æŸä¸ªå…ƒç´ å­˜åœ¨æ—¶ï¼Œè®¾ç½®è¯¥å€¼ä¸º1
      /*
      ğŸ¯å®ƒä¸å­˜å‚¨å…ƒç´ æœ¬èº«ï¼ˆURLå­—ç¬¦ä¸²ï¼‰ï¼Œç”šè‡³ä¸å­˜å‚¨å…ƒç´ çš„å“ˆå¸Œå€¼ã€‚å®ƒä»…ä»…æ˜¯å°†å…ƒç´ å­˜åœ¨è¿™ä¸€äº‹å®ï¼Œç¼–ç åˆ°å…±äº«çš„æ¯”ç‰¹æ•°ç»„çš„æŸå‡ ä¸ªä½ç½®ä¸Šï¼›
      ğŸ¯é—´æ¥çš„ã€åˆ†å¸ƒå¼çš„ã€å…±äº«çš„è®°å½•æ–¹å¼ï¼šé—´æ¥ï¼šä½ ä¸çŸ¥é“å“ªä¸ªå…ƒç´ è®¾ç½®äº†å“ªäº›ä½ã€‚åˆ†å¸ƒå¼ï¼šä¸€ä¸ªå…ƒç´ çš„èº«ä»½ç”±å¤šä¸ªä½å…±åŒè¡¨ç¤ºã€‚å…±äº«çš„ï¼šåŒä¸€ä¸ªä½å¯ä»¥è¢«æ— æ•°ä¸ªå…ƒç´ å…±äº«
      ğŸ¯æ½œåœ¨ä»£ä»·â€”â€”è¯¯æŠ¥çš„æ ¹æºï¼šè¿™ä¸ªæ“ä½œæ˜¯ç›²ç›®çš„ï¼Œä½çš„å…±äº«å¸¦æ¥äº†ä¸å¯é¿å…çš„é”™è¯¯åˆ¤æ–­ï¼›ä½æœ¬èº«æ˜¯å…¬å…±è´¢äº§ï¼Œä½å…±äº«æœºåˆ¶å¿…ç„¶ä¼šå¯¼è‡´çš„ç»“æœ
      ğŸ¯å…±äº«åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼š
      1.ä½æ˜¯å…¬å…±èµ„æºï¼šæ²¡æœ‰ä¸€ä¸ªä½æ˜¯æŸä¸ªå…ƒç´ ç§æœ‰çš„
      2.èº«ä»½ç”±æ¨¡å¼å®šä¹‰ï¼šä¸€ä¸ªå…ƒç´ çš„èº«ä»½ï¼Œç”±å®ƒç‹¬å çš„ä½ç»„åˆæ¨¡å¼å®šä¹‰ï¼Œè€Œä¸æ˜¯ç”±æŸä¸ªå•ç‹¬çš„ä½å®šä¹‰
      3.è¯¯æŠ¥çš„æ ¹æºï¼šå½“ä¸€ä¸ªä¸å­˜åœ¨çš„å…ƒç´ ï¼Œå…¶ä½ç»„åˆæ¨¡å¼æ°å¥½è¢«ä¸€ä¸ªæˆ–å¤šä¸ªå·²å­˜åœ¨å…ƒç´ çš„ä½é€šè¿‡å…±äº«æ‹¼å‡‘å‡ºæ¥æ—¶ï¼Œè¯¯æŠ¥å°±å‘ç”Ÿäº†
      æ— æ³•æ¶ˆé™¤è¿™ç§å…±äº«ï¼šå…±äº«æ‰å¸¦æ¥äº†æè‡´çš„ç©ºé—´æ•ˆç‡ï¼Œåªèƒ½é€šè¿‡å¢å¤§æ•°ç»„å’Œä½¿ç”¨æ›´å¤šå“ˆå¸Œå‡½æ•°æ¥é™ä½å…±äº«å¯¼è‡´è¯¯æŠ¥çš„æ¦‚ç‡
      */
  contains(item) {//å†³ç­–å‡½æ•°ï¼Œä¸€æ¬¡å­˜åœ¨æ€§çš„å¿«é€Ÿé¢„æ£€
    for (let i = 0; i < this.hashFunctions; i++) {//å¾ªç¯æ£€æŸ¥æ¯ä¸€ä¸ªå“ˆå¸Œå‡½æ•°å¯¹åº”çš„ä½ã€‚
      //  è·å–ç¬¬ i ä¸ªå“ˆå¸Œå‡½æ•°
      const hashFunc = this._hashFunction(i);
      // è®¡ç®—å…ƒç´ éœ€è¦æ£€æŸ¥çš„ä½çš„ä½ç½®
      const position = hashFunc(item);
      // æ£€æŸ¥è¯¥ä½ç½®çš„å€¼æ˜¯å¦ä¸º 0
      // å¦‚æœå‘ç°æ˜¯ 0ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³è¿”å› false
      if (this.bitArray[position] === 0) {//ä¸€æ—¦å‘ç°æŸä¸ªä½æ˜¯ 0ï¼Œå°±å¯ä»¥ç«‹å³æ–­å®šå…ƒç´ ä¸å­˜åœ¨ï¼Œè¿”å› false
        return false; // è‚¯å®šä¸å­˜åœ¨//å¸ƒéš†è¿‡æ»¤å™¨æœ€æ ¸å¿ƒã€æœ€å¯é çš„ä»·å€¼ï¼šæä¾›æ— å¯è¾©é©³çš„â€œå¦å®šâ€ç­”æ¡ˆ
      }
    }
    // å¦‚æœæ‰€æœ‰ä½ç½®éƒ½æ˜¯1ï¼Œè¿”å›true//åªæœ‰æ‰€æœ‰ä½éƒ½æ˜¯1ï¼Œæ‰è¿”å›trueï¼ˆæ³¨æ„ï¼Œè¿™è¡¨ç¤ºâ€œå¯èƒ½å­˜åœ¨â€ï¼Œä¸æ˜¯â€œä¸€å®šå­˜åœ¨â€ï¼‰
    return true; // å¯èƒ½å­˜åœ¨
  }
}
// æµ‹è¯•ä¸€ä¸‹ï¼
const bloom = new BloomFilter(100, 3); // æ•°ç»„å¤§å°100ï¼Œ3ä¸ªå“ˆå¸Œå‡½æ•°
bloom.add("hello");
bloom.add("world");
console.log(bloom.contains("hello")); // è¾“å‡º: true (ç¡®å®å­˜åœ¨)
console.log(bloom.contains("world")); // è¾“å‡º: true (ç¡®å®å­˜åœ¨)
console.log(bloom.contains("javascript")); // è¾“å‡º: false (è‚¯å®šä¸å­˜åœ¨ï¼Œæˆ‘ä»¬æ²¡æ·»åŠ å®ƒ)
/*
æ ¸å¿ƒä»·å€¼ï¼š
ğŸŸ¢é˜²æ­¢æ˜‚è´µçš„æµªè´¹ï¼šç«™åœ¨ä¸€ä¸ªæ˜‚è´µæ“ä½œçš„å‰é¢ï¼Œç”¨æä½çš„æˆæœ¬æ‹¦æˆªæ‰ç»å¤§å¤šæ•°æ— æ•ˆè¯·æ±‚
1.ç¼“å­˜å‡»ç©¿ä¿æŠ¤ï¼ˆCache Penetration Guardï¼‰
å½“æŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè¯·æ±‚ä¼šç»•è¿‡ç¼“å­˜ï¼ˆRedisï¼‰ï¼Œç›´æ¥å†²å‡»åº•å±‚æ•°æ®åº“ï¼ˆMySQLï¼‰ã€‚å¦‚æœæœ‰æµ·é‡æ­¤ç±»è¯·æ±‚ï¼Œæ•°æ®åº“ä¼šè¢«å‹å®ã€‚
åœ¨æŸ¥è¯¢ç¼“å­˜ä¹‹å‰ï¼Œå…ˆé—®å¸ƒéš†è¿‡æ»¤å™¨ï¼šâ€œè¿™ä¸ªé”®å¯èƒ½å­˜åœ¨å—ï¼Ÿâ€
å¦‚æœè¿”å› falseï¼ˆè‚¯å®šä¸å­˜åœ¨ï¼‰ï¼Œç›´æ¥è¿”å›ç”¨æˆ·â€œæ•°æ®ä¸å­˜åœ¨â€ï¼Œå®Œç¾ä¿æŠ¤äº†æ•°æ®åº“ã€‚
å¦‚æœè¿”å› trueï¼ˆå¯èƒ½å­˜åœ¨ï¼‰ï¼Œæ‰å…è®¸å»æŸ¥è¯¢ç¼“å­˜å’Œæ•°æ®åº“ã€‚
ä»·å€¼ï¼šç”¨ä¸€ä¸ª100MBçš„è¿‡æ»¤å™¨ï¼Œä¿æŠ¤äº†ä¸€ä¸ªä»·å€¼ç™¾ä¸‡ã€æ‰¿è½½æ ¸å¿ƒä¸šåŠ¡çš„æ•°æ®åº“é›†ç¾¤ã€‚
2.çˆ¬è™«å»é‡ï¼ˆWeb Crawler Deduplicationï¼‰
3.é«˜é£é™©æ“ä½œå‰ç½®æ£€æŸ¥
åœ¨æ‰§è¡Œä¸€ä¸ªé«˜æˆæœ¬çš„AIæ¨ç†æˆ–å¤æ‚è®¡ç®—å‰ï¼Œå…ˆç”¨å¸ƒéš†è¿‡æ»¤å™¨æ£€æŸ¥è¾“å…¥æ˜¯å¦å·²ç»è¢«å¤„ç†è¿‡ã€‚
åœ¨æ•°æ®åº“æ‰§è¡Œä¸€ä¸ªå…¨è¡¨æ‰«æçš„å¤æ‚æŸ¥è¯¢å‰ï¼Œå…ˆç”¨å¸ƒéš†è¿‡æ»¤å™¨æ£€æŸ¥ç›®æ ‡æ•°æ®æ˜¯å¦æ ¹æœ¬ä¸å­˜åœ¨ã€‚
ğŸŸ¢å®ç°æ¦‚ç‡æ€§æ¶æ„ï¼Œæ‹¥æŠ±ä¸ç¡®å®šæ€§
100%çš„ç²¾ç¡®å¹¶éæ€»æ˜¯æœ€ä¼˜è§£ï¼Œæœ‰æ—¶ç”¨å¯æ§åˆ¶çš„å¾®å°çš„é”™è¯¯ç‡å»æ¢å–æ•°é‡çº§ä¸Šçš„æ€§èƒ½æå‡
1. åˆ†å¸ƒå¼æ•°æ®åº“/ç¼“å­˜ï¼ˆå¦‚Apache Cassandra, Redisï¼‰
åœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œæ•°æ®è¢«åˆ†ç‰‡å­˜å‚¨åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚è¦æŸ¥è¯¢ä¸€ä¸ªé”®ï¼Œéœ€è¦çŸ¥é“å®ƒåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦‚æœç›´æ¥å»æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ‰¾ï¼Œæˆæœ¬æé«˜ã€‚
æ¯ä¸ªèŠ‚ç‚¹éƒ½ç»´æŠ¤ä¸€ä¸ªå¸ƒéš†è¿‡æ»¤å™¨ï¼Œè®°å½•è‡ªå·±å¯èƒ½å­˜æœ‰çš„é”®ã€‚å®¢æˆ·ç«¯å…ˆè¯¢é—®æ‰€æœ‰èŠ‚ç‚¹çš„è¿‡æ»¤å™¨ï¼Œåªæœ‰é‚£äº›è¿”å› true çš„èŠ‚ç‚¹æ‰éœ€è¦è¢«çœŸæ­£æŸ¥è¯¢ã€‚
ä»·å€¼ï¼šå°†ä¸€æ¬¡æ˜‚è´µçš„å¹¿æ’­æŸ¥è¯¢ï¼Œå˜æˆäº†å‡ æ¬¡ç²¾å‡†çš„ç‚¹å¯¹ç‚¹æŸ¥è¯¢
2. å†…å®¹åˆ†å‘ç½‘ç»œä¸åƒåœ¾é‚®ä»¶è¿‡æ»¤
å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªç½‘é¡µæˆ–é‚®ä»¶åœ°å€æ˜¯å¦åœ¨é»‘åå•ä¸­ã€‚å³ä½¿æœ‰ä¸‡åˆ†ä¹‹ä¸€çš„è¯¯æŠ¥ï¼ˆå¥½é‚®ä»¶è¢«è¯¯åˆ¤ä¸ºåƒåœ¾é‚®ä»¶ï¼‰ï¼Œç”¨æˆ·ä¹Ÿèƒ½ä»åƒåœ¾ç®±é‡Œæ‰¾å›ï¼Œä½†ç³»ç»Ÿå´å› æ­¤è·å¾—äº†åƒå€çš„æ€§èƒ½æå‡
ğŸŸ¢ä¿æŠ¤éšç§ä¸å®‰å…¨
1. å¯†ç æ³„éœ²æ£€æŸ¥ï¼ˆGoogle / Apple â€œéšç§ä¿æŠ¤â€è®¡åˆ’ï¼‰
ä½ æƒ³æ£€æŸ¥ä½ çš„å¯†ç æ˜¯å¦å·²ç»åœ¨å¤§è§„æ¨¡æ³„éœ²çš„å¯†ç åº“ä¸­ï¼Œä½†åˆä¸èƒ½æŠŠä½ çš„å¯†ç æ˜æ–‡å‘ç»™æœåŠ¡å™¨
æœåŠ¡å™¨ï¼ˆå¦‚Googleï¼‰å°†å·²çŸ¥çš„æ³„éœ²å¯†ç åº“é¢„å…ˆå­˜å…¥ä¸€ä¸ªå¸ƒéš†è¿‡æ»¤å™¨ã€‚ä½ çš„è®¾å¤‡ä¸‹è½½è¿™ä¸ªè¿‡æ»¤å™¨çš„ä½æ•°ç»„ã€‚ä½ çš„è®¾å¤‡åœ¨æœ¬åœ°ç”¨ä½ çš„å¯†ç å»æŸ¥è¯¢è¿™ä¸ªè¿‡æ»¤å™¨ã€‚å¦‚æœè¿”å› falseï¼šå¤ªå¥½äº†ï¼ä½ çš„å¯†ç è‚¯å®šä¸åœ¨æ³„éœ²åº“ä¸­ã€‚å¦‚æœè¿”å› trueï¼šä½ çš„å¯†ç å¯èƒ½æ³„éœ²äº†ï¼Œä½ åº”è¯¥ä¿®æ”¹å®ƒã€‚æœåŠ¡å™¨è‡ªå§‹è‡³ç»ˆéƒ½ä¸çŸ¥é“ä½ çš„å¯†ç æ˜¯ä»€ä¹ˆï¼
ä»·å€¼ï¼šå®ç°äº†å®‰å…¨æ£€æŸ¥ï¼ŒåŒæ—¶å®Œç¾ä¿æŠ¤äº†ç”¨æˆ·æœ€æ ¸å¿ƒçš„éšç§
ğŸŸ¢å®ƒçš„æ ¸å¿ƒä»·å€¼ï¼Œå°±åœ¨äºå®ƒèƒ½è®©ä½ ç”¨æœ€å°çš„ä»£ä»·ï¼Œä¸ºä½ çš„ç³»ç»Ÿæ„å»ºèµ·ç¬¬ä¸€é“ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€é“æ™ºèƒ½é˜²çº¿
*/
/*-------å·¥ä¸šç‰ˆæœ¬å¸ƒéš†è¿‡æ»¤å™¨--------/
å¸ƒéš†è¿‡æ»¤å™¨çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šç”¨å¤šä¸ªé—´æ¥è¯æ®çš„å…±è¯†æ¥ä»£æ›¿ç›´æ¥è¯æ®çš„å­˜å‚¨//åœ¨ä¸ç¡®å®šæ€§ä¸­å¯»æ‰¾æœ€ä¼˜è§£ï¼Œç”¨æ¦‚ç‡æ¢æ€§èƒ½
1. å“ˆå¸Œå‡½æ•°çš„å‡çº§
    é—®é¢˜ï¼šåˆ†å¸ƒä¸å‡åŒ€ã€å®¹æ˜“å†²çªã€ç§å­æ–¹æ¡ˆä¸ä¸¥è°¨ã€‚
    è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å·¥ä¸šçº§çš„ã€éåŠ å¯†çš„å“ˆå¸Œå‡½æ•°ã€‚
        ä¾‹å¦‚ï¼šmurmurHash, xxHash, fnv ç­‰ã€‚
        ä½œç”¨ï¼šå®ƒä»¬èƒ½ä¿è¯å³ä½¿è¾“å…¥ç›¸ä¼¼ï¼Œè¾“å‡ºä¹Ÿå‡åŒ€åˆ†å¸ƒåœ¨æ•´ä¸ªèŒƒå›´å†…ï¼Œæå¤§é™ä½è¯¯æŠ¥ç‡ã€‚
2. ä½æ•°ç»„çš„å‡çº§
æˆ‘ä»¬ç”¨ Array å­˜å‚¨ 0 å’Œ 1ï¼Œè¿™åœ¨å†…å­˜ä¸Šæ˜¯å·¨å¤§æµªè´¹ã€‚
    é—®é¢˜ï¼šä¸€ä¸ª Number ç±»å‹çš„æ•°ç»„å…ƒç´ å¯èƒ½å 8ä¸ªå­—èŠ‚(64ä½)ï¼Œä½†æˆ‘ä»¬åªç”¨äº†1ä¸ªæ¯”ç‰¹ã€‚
    è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ BitSet æˆ– TypedArrayã€‚
        ä½œç”¨ï¼šä¸€ä¸ª Uint8Array çš„æ¯ä¸ªå…ƒç´ æ˜¯8ä½ï¼Œå¯ä»¥è¡¨ç¤º8ä¸ªæ¯”ç‰¹ã€‚å†…å­˜å ç”¨ç¬é—´é™ä¸ºåŸæ¥çš„ 1/64ã€‚
3. å‚æ•°çš„ä¼˜åŒ–ä¸ä¼°ç®—
ä¸èƒ½éšä¾¿æ‹è„‘è¢‹å†³å®š size å’Œ hashFunctions çš„å€¼
    éœ€è¦æ ¹æ®é¢„æœŸæ•°æ®é‡ n å’Œå¯æ¥å—çš„è¯¯æŠ¥ç‡ p æ¥ç§‘å­¦è®¡ç®—ã€‚
    å­˜åœ¨ä¸€ä¸ªè‘—åçš„å…¬å¼æ¥è®¡ç®—æœ€ä¼˜çš„ size (m) å’Œ hashFunctions (k)ï¼š
        m=âˆ’nlnâ¡p(lnâ¡2)2m=âˆ’(ln2)2nlnpâ€‹
        k=mnlnâ¡2k=nmâ€‹ln2
4. æŒä¹…åŒ–ä¸åˆ†å¸ƒå¼ï¼ˆ
    æŒä¹…åŒ–ï¼šå†…å­˜ä¸­çš„è¿‡æ»¤å™¨é‡å¯å°±æ²¡äº†ã€‚éœ€è¦èƒ½åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œå¹¶èƒ½å¿«é€ŸåŠ è½½ã€‚
    åˆ†å¸ƒå¼ï¼šä¸€ä¸ªçˆ¬è™«æ˜¯åˆ†å¸ƒå¼çš„ã€‚éœ€è¦ä¸€ä¸ªå…±äº«çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå¯èƒ½åŸºäº Redis çš„ SETBIT å’Œ GETBIT å‘½ä»¤æ¥å®ç°ï¼Œè®©æ‰€æœ‰çˆ¬è™«èŠ‚ç‚¹éƒ½èƒ½æŸ¥è¯¢å’Œæ›´æ–°åŒä¸€ä¸ªè¿‡æ»¤å™¨ã€‚
å·¥ç¨‹å®ç°ï¼š
é«˜æ€§èƒ½ã€ä½ç¢°æ’çš„å“ˆå¸Œå‡½æ•°ã€‚æè‡´å‹ç¼©çš„ä½æ•°ç»„å­˜å‚¨ã€‚åŸºäºæ•°å­¦å…¬å¼çš„æœ€ä¼˜å‚æ•°è°ƒä¼˜ã€‚æŒä¹…åŒ–ä¸åˆ†å¸ƒå¼æ”¯æŒã€‚
    */
import murmur from 'murmurhash-js';//murmurhash-js æ˜¯ä¸€ä¸ª Node.js æ¨¡å—ï¼Œæ§åˆ¶å°ç¡®å®ä¸èƒ½ç›´æ¥ä½¿ç”¨ npm åŒ…çš„ murmurhash
class BloomFilter {
  constructor(size, hashFunctions) {
    // è®¡ç®—éœ€è¦å¤šå°‘ä¸ªå­—èŠ‚æ¥å­˜å‚¨ size ä¸ªæ¯”ç‰¹
    this.byteCount = Math.ceil(size / 8);
    // ä½¿ç”¨ TypedArrayï¼ŒçœŸæ­£èŠ‚çœå†…å­˜
    this.bitArray = new Uint8Array(this.byteCount);
    this.hashFunctions = hashFunctions;
    this.size = size;
  }
  // é‡å†™å“ˆå¸Œå‡½æ•°ç”Ÿæˆå™¨
  _hashFunction(seed) {
    return (str) => {
      // ä½¿ç”¨ murmurHash äº§ç”Ÿä¸€ä¸ª32ä½æ•´æ•°ï¼Œç„¶åå–æ¨¡
      const hash = murmur.murmur3(str, seed);
      return Math.abs(hash % this.size);
    };
    /*
    ç¬¬ä¸€è¡Œï¼šreturn (str) => { ... }è¿™ä»ç„¶æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ç”¨é—­åŒ…æŠŠ seed å°è£…åœ¨è¿”å›çš„å‡½æ•°é‡Œ
    ç¬¬äºŒè¡Œï¼šconst hash = murmur.murmur3(str, seed);murmur.murmur3ï¼šè°ƒç”¨ä¸€ä¸ªå·¥ä¸šçº§çš„å“ˆå¸Œç®—æ³•ï¼Œstrï¼šè¾“å…¥å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚ "https://example.com"ï¼‰
          seedï¼šéšæœºç§å­ï¼ˆæˆ‘ä»¬ä¼ å…¥çš„ iï¼‰
    MurmurHash åšäº†ä»€ä¹ˆï¼šå®ƒæ¥æ”¶ä»»æ„é•¿åº¦çš„è¾“å…¥æ•°æ®ï¼Œé€šè¿‡å¤æ‚çš„ä½è¿ç®—ã€æ—‹è½¬ã€æ··åˆæ“ä½œäº§ç”Ÿä¸€ä¸ª32ä½æ•´æ•°çš„è¾“å‡º
                       å…³é”®ç‰¹æ€§ï¼šé›ªå´©æ•ˆåº”â€”â€”è¾“å…¥çš„å¾®å°å˜åŒ–ä¼šå¯¼è‡´è¾“å‡ºçš„å·¨å¤§å˜åŒ–
                       å¤æ‚æ··åˆè¿ç®—ï¼Œå³ä½¿ç›¸ä¼¼çš„è¾“å…¥ä¹Ÿäº§ç”Ÿå®Œå…¨ä¸åŒçš„è¾“å‡º
    ç¬¬ä¸‰è¡Œï¼šreturn Math.abs(hash % this.size);
    hash % this.sizeï¼šå°†å·¨å¤§çš„32ä½æ•´æ•°æ˜ å°„åˆ°æˆ‘ä»¬çš„ä½æ•°ç»„èŒƒå›´å†…ï¼ŒMath.absï¼šç¡®ä¿ç»“æœæ˜¯æ­£æ•°ï¼ˆå› ä¸ºJavaScriptçš„å–æ¨¡å¯èƒ½è¿”å›è´Ÿæ•°ï¼‰
    MurmurHash æ›´ä¼˜ç§€ï¼š1. æ›´å¥½çš„åˆ†å¸ƒæ€§ï¼Œ2. æ›´å¼ºçš„æŠ—ç¢°æ’æ€§3. æ›´é«˜çš„æ€§èƒ½ï¼šMurmurHashä¼˜åŒ–çš„åº•å±‚æ“ä½œï¼Œå³ä½¿å¯¹é•¿å­—ç¬¦ä¸²ä¹Ÿå¾ˆå¿«

    */
  }
  // å·¥å…·æ–¹æ³•ï¼šè®¾ç½®ç‰¹å®šä½ä¸º1
  _setBit(position) {
    // æ‰¾åˆ°è¿™ä¸ªä½åœ¨å“ªä¸ªå­—èŠ‚é‡Œ
    const byteIndex = Math.floor(position / 8);//å°†æŠ½è±¡çš„â€œä½ä½ç½®â€è½¬æ¢æˆè®¡ç®—æœºå†…å­˜ä¸­å…·ä½“çš„â€œå­—èŠ‚åœ°å€å’Œä½åç§»â€
    // æ‰¾åˆ°è¿™ä¸ªä½åœ¨è¯¥å­—èŠ‚ä¸­çš„ç¬¬å‡ ä½ï¼ˆä»å³å¾€å·¦ï¼‰
    const bitIndex = position % 8;
    // ä½¿ç”¨ä½æ“ä½œORæ¥è®¾ç½®ç‰¹å®šä½ï¼Œä¸å½±å“å…¶ä»–ä½
    this.bitArray[byteIndex] |= (1 << bitIndex);//ç²¾å‡†ç‚¹äº®å•ä¸ªæ¯”ç‰¹ï¼ŒåŒæ—¶ç»ä¸æ‰“æ‰°å…¶ä»–é‚»å±…ï¼Œ<< æ˜¯å·¦ç§»ä½è¿ç®—ç¬¦
    /*
    ğŸŸ¢1ä¸ªå­—èŠ‚(Byte) = 8ä¸ªæ¯”ç‰¹(Bit)ã€‚Uint8Array ä¸­çš„æ¯ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼ŒbyteIndex å‘Šè¯‰æˆ‘ä»¬ç›®æ ‡åœ¨å“ªä¸ªå­—èŠ‚é‡Œï¼ŒbitIndex å‘Šè¯‰æˆ‘ä»¬ç›®æ ‡åœ¨è¿™ä¸ªå­—èŠ‚é‡Œçš„å“ªä¸ªæ¯”ç‰¹ä½ä¸Š
      è¿™å®é™…ä¸Šæ˜¯åœ¨åšè¿›åˆ¶è½¬æ¢â€”â€”æŠŠä»¥"ä½"ä¸ºå•ä½çš„çº¿æ€§åœ°å€ï¼Œè½¬æ¢æˆä»¥"å­—èŠ‚"ä¸ºå•ä½çš„äºŒç»´åœ°å€ï¼š
      å•† (Math.floor(position / 8)) æ˜¯è¡Œå·ï¼ˆå­—èŠ‚ç´¢å¼•ï¼‰
      ä½™æ•° (position % 8) æ˜¯åˆ—å·ï¼ˆä½ç´¢å¼•ï¼‰
    ğŸŸ¢<< æ˜¯å·¦ç§»ä½è¿ç®—ç¬¦ï¼š1 åœ¨äºŒè¿›åˆ¶ä¸­æ˜¯ï¼š00000001ï¼Œ1 << 7 çš„æ„æ€æ˜¯ï¼šæŠŠ1å‘å·¦ç§»åŠ¨7ä½ï¼Œ(1 << 7)å¾—åˆ°äº†ä¸€ä¸ªäºŒè¿›åˆ¶æ•° 10000000
      |= æ˜¯æŒ‰ä½æˆ–èµ‹å€¼è¿ç®—ç¬¦ï¼Œæ‰§è¡ŒæŒ‰ä½æˆ–æ“ä½œ A | Bï¼Œå°†ç»“æœèµ‹å€¼ç»™ A
      ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡â€œç²¾å‡†å·¥å…·â€ï¼š          ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œâ€œç²¾å‡†æ“ä½œâ€â€”â€” |=   //æŒ‰ä½æˆ–çš„è§„åˆ™ï¼š åªè¦å¯¹åº”ä½ç½®æœ‰ä¸€ä¸ªæ˜¯1ï¼Œç»“æœå°±æ˜¯1
      åˆå§‹:   00000001               å‡è®¾æˆ‘ä»¬ç¬¬2å·æˆ¿é—´çš„å½“å‰çŠ¶æ€æ˜¯ï¼š01101001ï¼ˆè¿™ä»£è¡¨ç¬¬0ã€3ã€5ã€6å·ä½å·²ç»æœ‰äººäº†ï¼Œå…¶ä»–ç©ºç€ï¼‰
          << 1:  00000010             æˆ¿é—´åŸçŠ¶æ€: 01101001
          << 2:  00000100             æˆ‘ä»¬çš„å·¥å…·: 10000000
          << 7:  10000000             æŒ‰ä½æˆ–æ“ä½œ: ---------
                                              | 11101001ç¬¬7å·ä½ï¼šä»0å˜æˆäº†1ï¼ˆæˆåŠŸç‚¹äº®ï¼ï¼‰å…¶ä»–æ‰€æœ‰ä½ï¼šçŠ¶æ€å®Œå…¨æ²¡æœ‰æ”¹å˜ï¼ç¬¬0ã€3ã€5ã€6å·ä½ä»ç„¶æ˜¯1ï¼Œç¬¬1ã€2ã€4å·ä½ä»ç„¶æ˜¯0ã€‚
                                    æˆ¿é—´çš„æ–°çŠ¶æ€æ˜¯11101001        
          
    ğŸŸ¢1.ç²¾å‡†æ€§ï¼š(1 << bitIndex) åˆ›é€ äº†ä¸€ä¸ªä½æ©ç ï¼Œå®ƒåƒæ‰‹æœ¯åˆ€ä¸€æ ·ç²¾å‡†ï¼Œåªé’ˆå¯¹ç›®æ ‡ä½    
      2.å®‰å…¨æ€§ï¼šä½¿ç”¨ |=ï¼ˆæŒ‰ä½æˆ–ï¼‰æ˜¯å®‰å…¨çš„ï¼šå¦‚æœç›®æ ‡ä½å·²ç»æ˜¯ 1ï¼Œæ“ä½œåè¿˜æ˜¯ 1ï¼ˆä¸ä¼šå‡ºé”™ï¼‰ï¼Œå¦‚æœç›®æ ‡ä½æ˜¯ 0ï¼Œæ“ä½œåå˜æˆ 1ï¼ˆè¾¾æˆç›®æ ‡ï¼‰ï¼Œå…¶ä»–æ‰€æœ‰ä½å®Œå…¨ä¸å—å½±å“
      3.åŸå­æ€§æ€ç»´ï¼šè¿™ä¸ªæ“ä½œåœ¨æ¦‚å¿µä¸Šæ˜¯åŸå­çš„â€”â€”æˆ‘ä»¬åªå…³å¿ƒâ€œæŠŠè¿™ä¸ªä½è®¾ä¸º1â€ï¼Œä¸å…³å¿ƒå®ƒä¹‹å‰æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Œä¹Ÿä¸å½±å“å…¶ä»–ä½ã€‚
      4.ç”¨æœ€åŸºç¡€çš„ä½è¿ç®—ï¼Œå®ç°äº†ç²¾ç¡®çš„ä½çº§æ“ä½œ
    */
  }

  // å·¥å…·æ–¹æ³•ï¼šè·å–ç‰¹å®šä½çš„å€¼
  _getBit(position) {
    const byteIndex = Math.floor(position / 8);
    const bitIndex = position % 8;
    // ä½¿ç”¨ä½æ“ä½œ AND æ¥æ£€æŸ¥ç‰¹å®šä½æ˜¯å¦ä¸º1
    return (this.bitArray[byteIndex] & (1 << bitIndex)) !== 0;//å®ƒè´Ÿè´£æ£€æŸ¥ä¸€ä¸ªç‰¹å®šçš„ä½æ˜¯å¦è¢«è®¾ç½®äº†
    /*
    ğŸŸ¢éç ´åæ€§åœ°è¯»å–ç‰¹å®šçŠ¶æ€
      ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æ¢æµ‹å·¥å…·â€”â€” (1 << 7)               ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œæ¢æµ‹æ“ä½œâ€”â€” &ï¼Œ& æ˜¯æŒ‰ä½ä¸è¿ç®—ç¬¦
                1 åœ¨äºŒè¿›åˆ¶æ˜¯ 00000001             å‡è®¾ç¬¬2å·æˆ¿é—´çš„å½“å‰çŠ¶æ€æ˜¯ï¼š11101001ï¼ˆç¬¬0ã€3ã€5ã€6ã€7å·ä½æœ‰äººï¼‰
                1 << 7 å¾—åˆ° 10000000             æˆ¿é—´çŠ¶æ€:11101001
      åªæœ‰ä¸€ä¸ªå­”ï¼ˆåœ¨ç¬¬7å·ä½ç½®ï¼‰ï¼Œå…¶ä»–åœ°æ–¹éƒ½æ˜¯å°é—­çš„      æ¢æµ‹é•œ: 10000000
                                              æŒ‰ä½ä¸æ“ä½œ:---------æŒ‰ä½ä¸çš„è§„åˆ™ï¼š åªæœ‰ä¸¤ä¸ªä½ç½®éƒ½æ˜¯1ï¼Œç»“æœæ‰æ˜¯1
                                                      & 10000000
      ç¬¬ä¸‰æ­¥ï¼šåˆ†ææ¢æµ‹ç»“æœâ€”â€” !== 0
      ç°åœ¨æˆ‘ä»¬åˆ¤æ–­ï¼š10000000 !== 0 å—10000000 æ˜æ˜¾ä¸ç­‰äº 00000000ï¼ˆ0ï¼‰
      ç»“æœæ˜¯trueç¬¬7å·ä½æœ‰äºº
    ğŸŸ¢1.ç²¾å‡†æ¢æµ‹ï¼š(1 << bitIndex) åˆ›é€ çš„ä½æ©ç ç¡®ä¿æˆ‘ä»¬åªæ£€æŸ¥ç›®æ ‡ä½ï¼Œå®Œå…¨å¿½ç•¥å…¶ä»–ä½ 
      2.å¸ƒå°”åŒ–è½¬æ¢ï¼š!== 0 å·§å¦™åœ°å°†ä¸€ä¸ªæ•°å­—è½¬æ¢æˆäº†å¸ƒå°”å€¼ï¼šå¦‚æœç›®æ ‡ä½æ˜¯1ï¼ŒæŒ‰ä½ä¸çš„ç»“æœæ˜¯ (1 << bitIndex)ï¼ˆä¸€ä¸ªä¸ç­‰äº0çš„æ•°ï¼‰â†’ trueï¼Œå¦‚æœç›®æ ‡ä½æ˜¯0ï¼ŒæŒ‰ä½ä¸çš„ç»“æœæ˜¯ 0 â†’ false
      3.çº¯ç²¹æŸ¥è¯¢ï¼šè¿™ä¸ªæ“ä½œæ˜¯åªè¯»çš„ï¼Œå®ƒåªæ˜¯æ£€æŸ¥çŠ¶æ€ï¼Œå®Œå…¨ä¸ä¼šæ”¹å˜ä»»ä½•æ•°æ®
      */                                           
  }
  //ä¿®æ”¹addå’Œcontainsæ–¹æ³•
  add(item) {
    /*
    item æ˜¯å­—ç¬¦ä¸²ï¼Œå¸ƒéš†è¿‡æ»¤å™¨çš„ add æ–¹æ³•ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™ä¸ªå¾ªç¯ç»“æ„å®ç°äº†
    1.å¤šå“ˆå¸Œç­–ç•¥ï¼šé€šè¿‡è¿­ä»£ this.hashFunctions æ¬¡ï¼Œä¸ºæ¯ä¸ªæ•°æ®é¡¹ç”Ÿæˆ k ä¸ªç‹¬ç«‹çš„ä½ç´¢å¼•
    2.å‡åŒ€åˆ†å¸ƒï¼šæ¯ä¸ªå®ä¾‹åŒ–çš„å“ˆå¸Œå‡½æ•° hashFunc éƒ½åŠ›æ±‚æ»¡è¶³å‡åŒ€åˆ†å¸ƒå‡è®¾ï¼Œç¡®ä¿ä½ç´¢å¼•åœ¨æ•°ç»„ä¸­å‡åŒ€æ•£å¸ƒã€‚
    3.ä½å‘é‡è®¾ç½®ï¼šè®¡ç®—å‡ºçš„æ¯ä¸ª position å¯¹åº”äºä½å‘é‡ä¸­çš„ç‰¹å®šæ¯”ç‰¹ä½ï¼Œå°†å…¶ç½®ä¸º1ä»¥æ ‡è®°è¯¥é¡¹çš„å­˜åœ¨ã€‚
    */
    for (let i = 0; i < this.hashFunctions; i++) {
      const hashFunc = this._hashFunction(i);
      /*
      å“ˆå¸Œå‡½æ•°å®ä¾‹åŒ–ï¼Œhis._hashFunction æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒä½œä¸ºå“ˆå¸Œå‡½æ•°çš„å·¥å‚æ–¹æ³•ï¼Œå‚æ•° i ä½œä¸ºéšæœºç§å­ï¼Œç”¨äºç”Ÿæˆä¸€ä¸ªå…·æœ‰ç‹¬ç«‹åˆ†å¸ƒç‰¹æ€§çš„å“ˆå¸Œå‡½æ•°å®ä¾‹
      è¯¥è¡Œæ‰§è¡Œäº†å‡½æ•°æŸ¯é‡ŒåŒ–ï¼Œé€šè¿‡éƒ¨åˆ†åº”ç”¨ç§å­å‚æ•°ï¼Œä»é€šç”¨çš„å“ˆå¸Œç®—æ³•æ¨¡æ¿ä¸­å®ä¾‹åŒ–å‡ºä¸€ä¸ªå…·ä½“çš„å“ˆå¸Œå‡½æ•° hashFunc
      */
      const position = hashFunc(item);
      /*
      è®¡ç®—ä½ç´¢å¼•ï¼šå¯¹è¾“å…¥é¡¹ itemï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶æ•°æ®ï¼‰æ‰§è¡Œå“ˆå¸Œè®¡ç®—ï¼ŒhashFunc ä½œä¸ºç¡®å®šæ€§å‡½æ•°ï¼Œå¯¹åŒä¸€è¾“å…¥å§‹ç»ˆäº§ç”Ÿç›¸åŒçš„è¾“å‡º
      è¯¥æ“ä½œå°†ä»»æ„é•¿åº¦çš„è¾“å…¥ item é€šè¿‡å“ˆå¸Œæ˜ å°„åˆ°å›ºå®šçš„æ•´æ•°åŸŸ [0, this.size-1] ä¸­ï¼Œè¾“å‡ºå€¼positionæ˜¯è¯¥é¡¹åœ¨ä½æ•°ç»„ä¸­çš„ä½ç´¢å¼•ï¼Œç”¨äºåç»­çš„ä½æ“ä½œ
      */
      this._setBit(position); // ä½¿ç”¨æ–°çš„ä½è®¾ç½®æ–¹æ³•
    }
  }
  contains(item) {
    for (let i = 0; i < this.hashFunctions; i++) {
      const hashFunc = this._hashFunction(i);
      const position = hashFunc(item);
      if (!this._getBit(position)) {//ä½¿ç”¨æ–°çš„ä½è¯»å–æ–¹æ³•
        return false;
      }
    }
    return true;
  }
//æ·»åŠ å®ç”¨å·¥å…·æ–¹æ³•
// ä¼°ç®—å½“å‰è¯¯æŠ¥ç‡ï¼ˆè¿‘ä¼¼å€¼ï¼‰
//åœ¨ä¸éå†æ¯ä¸ªä½çš„æƒ…å†µä¸‹ï¼Œä¼°ç®—å½“å‰å¸ƒéš†è¿‡æ»¤å™¨çš„è¯¯æŠ¥ç‡ï¼Œè¯¯æŠ¥ç‡ â‰ˆ (è¢«è®¾ç½®çš„ä½çš„æ¯”ä¾‹) ^ (å“ˆå¸Œå‡½æ•°æ•°é‡)ï¼ŒfalsePositiveRate â‰ˆ (setBits / totalBits) ^ k
  getEstimatedFalsePositiveRate() {
    // è®¡ç®—å·²è¢«è®¾ç½®çš„ä½çš„æ¯”ä¾‹
    let setBits = 0;
    for (let i = 0; i < this.byteCount; i++) {
      // è®¡ç®—ä¸€ä¸ªå­—èŠ‚ä¸­è¢«è®¾ç½®çš„ä½çš„æ•°é‡
      let byte = this.bitArray[i];
      while (byte) {
        setBits += byte & 1;
        byte >>= 1;
      }
      /*
      ğŸŸ¢å†…å¾ªç¯ï¼š
      æˆ‘ä»¬ä¸æ˜¯æ£€æŸ¥100ä¸‡ä¸ªä½ï¼Œè€Œæ˜¯æ£€æŸ¥å­—èŠ‚ï¼Œè¿™æ ·å¿«100ä¸‡å€
      å†…å±‚å¾ªç¯ while (byte)ï¼šä½ç½®: 7 6 5 4 3 2 1 0//æ•°ä¸€æ•°æœ‰å¤šå°‘ä¸ªæ­£é¢æœä¸Š     ç¬¬ä¸€è½®å¾ªç¯ï¼šæ£€æŸ¥æœ€å³è¾¹çš„æ­£åï¼šbyte & 1 æ˜¯åªå…³å¿ƒæœ€å³è¾¹é‚£ä¸ªæ­£åï¼ˆä½ç½®0ï¼‰
                            æ­£å: 0 1 1 0 1 0 0 1                         01101001 & 00000001 = 00000001 â†’ ç»“æœæ˜¯ 1
                                  â†‘             â†‘                        è¿™æ„å‘³ç€æœ€å³è¾¹çš„æ˜¯æ­£é¢æœä¸Šï¼ŒsetBits += 1 â†’ æˆ‘ä»¬æ•°åˆ°äº†1ä¸ªæ­£é¢
                                æœ€é«˜ä½        æœ€ä½ä½                       >>= 1 æ„æ€æ˜¯ï¼šæŠŠæ‰€æœ‰ç¡¬å¸å‘å³æ¨ä¸€æ ¼ï¼Œæœ€å³è¾¹çš„æ‰å‡ºå»ï¼Œæœ€å·¦è¾¹è¡¥0
                          
      ä¸€ç›´é‡å¤ï¼Œæ¯æ¬¡1.æ£€æŸ¥æœ€å³è¾¹çš„ç¡¬å¸æ˜¯æ­£é¢å—ï¼Ÿï¼ˆbyte & 1ï¼‰å¦‚æœæ˜¯æ­£é¢ï¼Œå°±è®¡æ•°+1ï¼ŒæŠŠç¡¬å¸æ•´ä½“å³æ¨ä¸€æ ¼ï¼ˆbyte >>= 1ï¼‰ç›´åˆ°æ‰€æœ‰ç¡¬å¸éƒ½ä»å³è¾¹æ‰å‡ºå»ï¼Œbyte å˜æˆ 00000000ï¼Œå¾ªç¯ç»“æŸã€‚
      è¿™ç§æ–¹æ³•æ¯”é€ä¸ªæ£€æŸ¥8ä¸ªä½è¦é«˜æ•ˆï¼šåªéœ€è¦å‡ æ¬¡ä½è¿ç®—ï¼Œè€Œä¸æ˜¯8æ¬¡æ¯”è¾ƒï¼ŒCPUå¤„ç†ä½è¿ç®—éå¸¸å¿«ï¼Œä»£ç ç®€æ´ä¼˜é›…ï¼šä½“ç°äº†"ç”¨æ•°å­¦å’Œä½è¿ç®—æ›¿ä»£æš´åŠ›æšä¸¾"çš„ä¼˜åŒ–æ€æƒ³
      ä¼°ç®—çš„ä»·å€¼ï¼š1.ç›‘æ§è¿‡æ»¤å™¨å¥åº·åº¦ï¼šå¦‚æœè¯¯æŠ¥ç‡æ¥è¿‘50%ï¼Œè¯´æ˜è¿‡æ»¤å™¨å¿«æ»¡äº†ï¼Œéœ€è¦æ‰©å®¹
                2.éªŒè¯å‚æ•°è®¾ç½®ï¼šæ£€æŸ¥å®é™…è¯¯æŠ¥ç‡æ˜¯å¦æ¥è¿‘æˆ‘ä»¬è®¾è®¡æ—¶çš„ç›®æ ‡ï¼ˆæ¯”å¦‚1%ï¼‰
                3.è°ƒè¯•å·¥å…·ï¼šå¦‚æœè¯¯æŠ¥ç‡å¼‚å¸¸é«˜ï¼Œå¯èƒ½æ˜¯å“ˆå¸Œå‡½æ•°æœ‰é—®é¢˜
      ğŸŸ¢å¤–å¾ªç¯ï¼š
      æŠŠæ•´ä¸ªä½æ•°ç»„æ£€æŸ¥ä¸€éï¼Œå¤–å±‚å¾ªç¯ç¡®ä¿æˆ‘ä»¬æ£€æŸ¥äº†ä½æ•°ç»„çš„æ¯ä¸€ä¸ªè§’è½ï¼Œæ²¡æœ‰é—æ¼ä»»ä½•ä¿¡æ¯
      ğŸŸ¢å†…å¤–å¾ªç¯çš„é…åˆï¼Œä½“ç°äº†è®¡ç®—æœºç§‘å­¦ä¸­å¸¸è§çš„åˆ†å±‚å¤„ç†æ€æƒ³ï¼šå¤–å±‚å¤„ç†å®è§‚ç»“æ„ï¼ˆå­—èŠ‚ï¼‰ï¼Œå†…å±‚å¤„ç†å¾®è§‚ç»†èŠ‚ï¼ˆæ¯”ç‰¹ï¼‰
      1.æ•ˆç‡ï¼šæŒ‰æˆ¿é—´ï¼ˆå­—èŠ‚ï¼‰éå†æ¯”æŒ‰ä½ç½®ï¼ˆæ¯”ç‰¹ï¼‰éå†å¿«8å€
      2.è‡ªç„¶ï¼šè®¡ç®—æœºå†…å­˜æœ¬æ¥å°±æ˜¯æŒ‰å­—èŠ‚ç»„ç»‡çš„
      3.ç®€æ´ï¼šä»£ç æ¸…æ™°åœ°è¡¨è¾¾äº†"æ£€æŸ¥æ¯ä¸ªå­—èŠ‚ï¼Œç»Ÿè®¡å…¶ä¸­çš„è®¾ç½®ä½"
                                */
    }
    const probability = setBits / this.size;//ç¬¬äºŒæ­¥ï¼šè®¡ç®—"ä½è¢«è®¾ç½®"çš„æ¦‚ç‡ï¼ŒsetBitsï¼šæˆ‘ä»¬åˆšæ‰æ•°å‡ºæ¥çš„ï¼Œæ€»å…±æœ‰å¤šå°‘ä¸ªä½è¢«è®¾ç½®ä¸º 1ï¼Œthis.sizeï¼šä½æ•°ç»„çš„æ€»å¤§å°ï¼ˆæ€»å…±æœ‰å¤šå°‘ä¸ªä½ï¼‰
    return Math.pow(probability, this.hashFunctions);// ç›¸å½“äºï¼šprobability Ã— probability Ã— ... (é‡å¤ this.hashFunctions æ¬¡)
    /*ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—è¯¯æŠ¥ç‡è¯¯æŠ¥çš„å‘ç”Ÿéœ€è¦ï¼šä¸€ä¸ªä¸å­˜åœ¨çš„å…ƒç´ ï¼Œå…¶æ‰€æœ‰ k ä¸ªå“ˆå¸Œä½ç½®éƒ½ç¢°å·§è¢«å…¶ä»–å…ƒç´ è®¾ç½®äº†
    è¯¯æŠ¥ç‡ = (å•ä¸ªä½è¢«è®¾ç½®çš„æ¦‚ç‡) ^ (å“ˆå¸Œå‡½æ•°æ•°é‡)æ¯ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡éƒ½æ˜¯ pï¼Œä¸”è¿™äº›äº‹ä»¶æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥æ€»çš„æ¦‚ç‡å°±æ˜¯ p^kã€‚
    å‡è®¾æˆ‘ä»¬çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼šä½æ•°ç»„å¤§å°ï¼š1000 ä½ï¼Œå“ˆå¸Œå‡½æ•°æ•°é‡ï¼š3 ä¸ªï¼Œå½“å‰å·²è®¾ç½®ï¼š400 ä¸ªä½
    è®¡ç®—ï¼š
    probability = 400 / 1000 = 0.4ï¼ˆ40%çš„ä½è¢«è®¾ç½®äº†ï¼‰è¯¯æŠ¥ç‡ = 0.4 ^ 3 = 0.4 Ã— 0.4 Ã— 0.4 = 0.064ï¼Œç»“æœï¼š å½“å‰è¯¯æŠ¥ç‡å¤§çº¦æ˜¯ 6.4%
    è¿™æ„å‘³ç€ï¼šæ¯æŸ¥è¯¢100ä¸ªä¸å­˜åœ¨çš„å…ƒç´ ï¼Œå¤§çº¦ä¼šæœ‰6ä¸ªè¢«è¯¯åˆ¤ä¸º"å¯èƒ½å­˜åœ¨"
    */
  }
  // æ¸…ç©ºè¿‡æ»¤å™¨
  clear() {
    this.bitArray = new Uint8Array(this.byteCount);
    /*
    new Uint8Array(this.byteCount) å¯¹äºå¸ƒéš†è¿‡æ»¤å™¨è¿™ç§é€šå¸¸è¾ƒå¤§çš„æ•°æ®ç»“æ„ï¼Œæ–°å»ºæ•°ç»„å‡ ä¹æ€»æ˜¯æ›´å¥½çš„é€‰æ‹©
    ğŸŸ¢æ€§èƒ½ä¼˜åŠ¿ï¼šæ˜¯ä¸€æ¬¡æ€§åˆ†é…å…¨æ–°çš„å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”è‡ªåŠ¨åˆå§‹åŒ–ä¸ºå…¨0ã€‚
    è€Œå¾ªç¯éå†è®¾ç½®æ¯ä¸ªå­—èŠ‚ï¼šéœ€è¦æ‰§è¡Œ this.byteCount æ¬¡èµ‹å€¼æ“ä½œï¼Œå¯¹äºå¤§å‹è¿‡æ»¤å™¨ï¼ˆæ¯”å¦‚1äº¿ä½ï¼‰ï¼Œè¿™æ„å‘³ç€1250ä¸‡æ¬¡å¾ªç¯ï¼æ¯æ¬¡å¾ªç¯éƒ½æœ‰æ•°ç»„ç´¢å¼•æŸ¥æ‰¾å’Œèµ‹å€¼å¼€é”€
    ğŸŸ¢å†…å­˜ç®¡ç†ï¼šåœ¨ç°ä»£JavaScriptå¼•æ“ä¸­ï¼Œåˆ›å»ºæ–°çš„ TypedArray é€šå¸¸æ¯”éå†ä¿®æ”¹ç°æœ‰æ•°ç»„æ›´é«˜æ•ˆ
    å†…å­˜åˆ†é…ä¼˜åŒ–ï¼šå¼•æ“å¯ä»¥ä¸€æ¬¡æ€§åˆ†é…è¿ç»­çš„å†…å­˜å—ï¼›åƒåœ¾å›æ”¶ï¼šæ—§çš„æ•°ç»„ä¼šè¢«åƒåœ¾å›æ”¶å™¨è‡ªåŠ¨æ¸…ç†ï¼›åˆå§‹åŒ–ä¼˜åŒ–ï¼šnew Uint8Array(size) çš„å…¨0åˆå§‹åŒ–å¯èƒ½ä½¿ç”¨åº•å±‚çš„é«˜æ•ˆå†…å­˜æ“ä½œ
    å†…å­˜å ç”¨ï¼šJavaScriptçš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šå¾ˆå¿«æ¸…ç†æ‰æ—§çš„æ•°ç»„å¼•ç”¨ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°é•¿æ—¶é—´çš„åŒå€å†…å­˜å ç”¨
    ğŸŸ¢ä»£ç ç®€æ´æ€§ä¸å¯é æ€§ï¼šæ„å›¾æ˜ç¡®ï¼šä¸€çœ¼å°±çŸ¥é“æ˜¯åœ¨åˆ›å»ºå…¨æ–°çš„ç©ºæ•°ç»„ï¼›æ²¡æœ‰å‰¯ä½œç”¨ï¼šä¸ä¼šå› ä¸ºå¾ªç¯ä¸­çš„bugå¯¼è‡´éƒ¨åˆ†æ•°æ®æ²¡æ¸…ç©ºï¼›åŸå­æ€§ï¼šèµ‹å€¼æ“ä½œæ˜¯åŸå­çš„ï¼Œä¸ä¼šå‡ºç°æ¸…ç©ºåˆ°ä¸€åŠçš„çŠ¶æ€
    */
  }
  // è·å–ç»Ÿè®¡ä¿¡æ¯
  getStats() {
    return {
      size: this.size,
      hashFunctions: this.hashFunctions,
      byteCount: this.byteCount,
      estimatedFalsePositiveRate: this.getEstimatedFalsePositiveRate()//åˆ›å»ºä¸€ä¸ªå±æ€§ estimatedFalsePositiveRateï¼Œå®ƒçš„å€¼ç­‰äºæ­¤åˆ»è°ƒç”¨ getEstimatedFalsePositiveRate() æ–¹æ³•çš„è¿”å›å€¼
    };
    /*
    getStats() æ–¹æ³•çš„å­˜åœ¨ï¼Œä½“ç°äº†ä» â€œèƒ½ç”¨çš„ä»£ç â€ åˆ° â€œå¥½ç”¨çš„å·¥å…·â€ çš„å…³é”®è½¬å˜ï¼›ä¸€ä¸ªâ€œç³»ç»Ÿä»ªè¡¨ç›˜â€
    ğŸŸ¢å››å¤§æ ¸å¿ƒä»·å€¼ï¼š
    1.ç›‘æ§ä¸è°ƒè¯•ï¼ˆæœ€é‡è¦çš„ä»·å€¼ï¼ï¼‰å¸ƒéš†è¿‡æ»¤å™¨è¡Œä¸ºå¼‚å¸¸
    2.å®¹é‡è§„åˆ’ä¸é¢„è­¦ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ éœ€è¦çŸ¥é“è¿‡æ»¤å™¨ä»€ä¹ˆæ—¶å€™ä¼šâ€œæ»¡â€ï¼›å®šæœŸæ£€æŸ¥è¿‡æ»¤å™¨å¥åº·åº¦
    3.å‚æ•°éªŒè¯ä¸ä¼˜åŒ–ï¼šä½ è°ƒæ•´å‚æ•°æ—¶ï¼Œéœ€è¦éªŒè¯æ•ˆæœï¼š è¾“å‡ºå¯¹æ¯”ï¼Œå¸®ä½ é€‰æ‹©æœ€ä¼˜å‚æ•°
    4.è¿ç»´ä¸æ—¥å¿—è®°å½•ï¼šåœ¨ç”Ÿäº§ç³»ç»Ÿä¸­ï¼Œä½ éœ€è¦è®°å½•çŠ¶æ€ï¼Œæ¯å°æ—¶è®°å½•ä¸€æ¬¡è¿‡æ»¤å™¨çŠ¶æ€
    ğŸŸ¢å·¥ç¨‹æ€ç»´çš„ä½“ç°ï¼š
    å¯è§‚æµ‹æ€§ï¼šç³»ç»Ÿåº”è¯¥èƒ½æŠ¥å‘Šè‡ªå·±çš„å†…éƒ¨çŠ¶æ€
    é€æ˜åŒ–ï¼šæŠŠé»‘ç›’å˜æˆç™½ç›’ï¼Œè®©ä½¿ç”¨è€…ç†è§£å†…éƒ¨è¿ä½œ
    æ•°æ®é©±åŠ¨ï¼šç”¨æ•°æ®è€Œä¸æ˜¯ç›´è§‰æ¥åšå†³ç­–
    é¢„é˜²æ€§ç»´æŠ¤ï¼šåœ¨é—®é¢˜å‘ç”Ÿå‰é¢„è­¦
    ğŸŸ¢è®©å¸ƒéš†è¿‡æ»¤å™¨ä»ä¸€ä¸ªç¥ç§˜çš„é»‘ç›’å­å˜æˆäº†ä¸€ä¸ªâ€œé€æ˜çš„ã€å¯ç›‘æ§çš„ã€å¯è°ƒè¯•çš„å·¥ç¨‹ç»„ä»¶â€ã€‚å®ƒå¯èƒ½åªå äº†1%çš„ä»£ç é‡ï¼Œä½†æä¾›äº†99%çš„å¯ç»´æŠ¤æ€§ä»·å€¼ï¼Œè¿™å°±æ˜¯ä¸“ä¸šå·¥ç¨‹ä»£ç ä¸ä¸šä½™è„šæœ¬çš„åŒºåˆ«æ‰€åœ¨
    ğŸŸ¢estimatedFalsePositiveRate: this.getEstimatedFalsePositiveRate()æ¯æ¬¡è°ƒç”¨ getStats() æ—¶ï¼Œå®ƒéƒ½ä¼šé‡æ–°è®¡ç®—å½“å‰çš„è¯¯æŠ¥ç‡ï¼Œç»™ä½ ä¸€ä¸ªæœ€æ–°çš„ã€å®æ—¶çš„çŠ¶æ€å¿«ç…§
    ä¼˜åŠ¿ï¼š æ•°æ®æ°¸è¿œæ˜¯æœ€æ–°çš„ï¼Œä¸éœ€è¦ç»´æŠ¤çŠ¶æ€ï¼Œä»£ç ç®€æ´ã€‚
    1. æ•°æ®å‡†ç¡®æ€§ï¼šè¯¯æŠ¥ç‡éšç€å…ƒç´ çš„æ·»åŠ ä¸æ–­å˜åŒ–ï¼›
    2. ä»£ç ç»´æŠ¤æ€§ï¼šä¸éœ€è¦åœ¨ add(), clear() ç­‰æ¯ä¸ªæ–¹æ³•é‡Œéƒ½è®°å¾—æ›´æ–°è¿™ä¸ªå€¼ï¼›
    3. è®¡ç®—å¼€é”€çš„åˆç†æ€§ï¼šè¯¯æŠ¥ç‡è®¡ç®—å¾ˆå¿«ï¼ˆåªæ˜¯ç»Ÿè®¡ä½æ•°é‡ç„¶ååšä¸ªå¹‚è¿ç®—ï¼‰getStats() ä¸ä¼šåœ¨å…³é”®æ€§èƒ½è·¯å¾„ä¸Šé¢‘ç¹è°ƒç”¨ï¼Œç”¨å°‘é‡è®¡ç®—å¼€é”€æ¢å–ä»£ç ç®€æ´æ€§å’Œæ•°æ®å‡†ç¡®æ€§æ˜¯å€¼å¾—çš„äº¤æ˜“
    ğŸŸ¢é‡è¦çš„è½¯ä»¶è®¾è®¡åŸåˆ™ï¼šä¼˜ç§€çš„APIè®¾è®¡ä¼šé‡‡ç”¨åŠ¨æ€è®¡ç®—è€Œä¸æ˜¯é™æ€å­˜å‚¨â€”â€”å®ƒè®©ä»£ç æ›´å¥å£®ã€æ›´æ˜“ç»´æŠ¤ã€æ›´ä¸å®¹æ˜“å‡ºé”™ï¼
    å•ä¸€èŒè´£ï¼šgetStats() åªè´Ÿè´£æŠ¥å‘ŠçŠ¶æ€ï¼Œä¸è´Ÿè´£ç»´æŠ¤çŠ¶æ€
    å®æ—¶æ€§ï¼šæ•°æ®åœ¨è¯·æ±‚æ—¶è®¡ç®—ï¼Œä¿è¯å‡†ç¡®æ€§
    ç®€æ´æ€§ï¼šé¿å…å†—ä½™çš„çŠ¶æ€ç»´æŠ¤ä»£ç 
    å°è£…æ€§ï¼šä½¿ç”¨è€…ä¸éœ€è¦å…³å¿ƒè¯¯æŠ¥ç‡æ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„
    */
  }
  /*
  å‚æ•°è‡ªåŠ¨åŒ–ä¸åºåˆ—åŒ–ï¼šç”¨æˆ·ä¸çŸ¥é“å¦‚ä½•è®¾ç½® size å’Œ hashFunctionsï¼Œä¸”è¿‡æ»¤å™¨çŠ¶æ€æ— æ³•ä¿å­˜
  é™æ€å·¥å‚æ–¹æ³•ï¼šæ ¹æ®é¢„æœŸæ•°æ®é‡å’Œå¯æ¥å—è¯¯æŠ¥ç‡åˆ›å»ºè¿‡æ»¤å™¨
  è§£å†³æ–¹æ¡ˆï¼šæä¾›å·¥å‚æ–¹æ³•ï¼Œæ ¹æ®æœŸæœ›å®¹é‡å’Œè¯¯æŠ¥ç‡è‡ªåŠ¨è®¡ç®—æœ€ä¼˜å‚æ•°ï¼Œå®ç°åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹æ³•ï¼Œä»¥ä¾¿å°†è¿‡æ»¤å™¨çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜æˆ–æ•°æ®åº“ã€‚*/
  static create(expectedItems, falsePositiveRate) {
    const n = expectedItems;
    const p = falsePositiveRate;
    // æœ€ä¼˜æ¯”ç‰¹æ•°è®¡ç®—å…¬å¼
    const m = Math.ceil(-(n * Math.log(p)) / (Math.LN2 ** 2));
    // æœ€ä¼˜å“ˆå¸Œå‡½æ•°æ•°é‡è®¡ç®—å…¬å¼
    const k = Math.max(1, Math.round((m / n) * Math.LN2));
    
    console.log(`åˆ›å»ºå¸ƒéš†è¿‡æ»¤å™¨: é¢„æœŸå…ƒç´ =${n}, è¯¯æŠ¥ç‡=${p}, æ¨èå¤§å°=${m}, æ¨èå“ˆå¸Œå‡½æ•°æ•°=${k}`);
    return new BloomFilter(m, k);
    /*
    ğŸŸ¢ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ€ä¼˜ä½æ•°ç»„å¤§å°mï¼Œconst m = Math.ceil(-(n * Math.log(p)) / (Math.LN2 ** 2));
    nï¼šé¢„æœŸå…ƒç´ æ•°é‡ï¼›pï¼šç›®æ ‡è¯¯æŠ¥ç‡ï¼›Math.LN2ï¼šè‡ªç„¶å¯¹æ•°ln(2)ï¼Œçº¦ç­‰äº0.693ï¼›è¦è¾¾åˆ°è¯¯æŠ¥ç‡pï¼Œå¯¹äºnä¸ªå…ƒç´ ï¼Œä½ éœ€è¦å¤§çº¦mä¸ªæ¯”ç‰¹ä½
    n=1000000, p=0.01 
    m = - (1000000 * ln(0.01)) / (ln(2))^2
      = - (1000000 * -4.605) / (0.480) 
      â‰ˆ 9,593,750 æ¯”ç‰¹ â‰ˆ 1.14 MB
    ğŸŸ¢ç¬¬äºŒæ­¥ï¼šè®¡ç®—æœ€ä¼˜å“ˆå¸Œå‡½æ•°æ•°é‡kï¼Œconst k = Math.max(1, Math.round((m / n) * Math.LN2));
    å¯¹äºç»™å®šçš„ä½æ•°ç»„å¤§å° m å’Œå…ƒç´ æ•°é‡ nï¼Œæœ€ä¼˜çš„å“ˆå¸Œå‡½æ•°æ•°é‡æ˜¯ (m/n) * ln(2)ï¼›ln(2)ï¼šæ•°å­¦è¯æ˜åœ¨è¿™ä¸ªæ¯”ä¾‹ä¸‹ï¼Œè¯¯æŠ¥ç‡æœ€ä½
    m=9593750, n=1000000ï¼›k = (9593750 / 1000000) * 0.693 â‰ˆ 6.64 â†’ å–æ•´ä¸º7
    ğŸŸ¢æ¦‚ç‡è®ºå’Œå¾®ç§¯åˆ†çš„æœ€ä¼˜åŒ–ï¼š
    è¯¯æŠ¥ç‡å…¬å¼ï¼šP â‰ˆ (1 - e^(-k*n/m))^kï¼Œå¯¹kæ±‚å¯¼ï¼Œæ‰¾åˆ°ä½¿Pæœ€å°çš„kå€¼ï¼šå¾—å‡ºæœ€ä¼˜è§£ï¼šk = (m/n) * ln(2)ï¼šä»£å…¥æ±‚è§£ï¼šå¾—åˆ°mçš„å…¬å¼
    æ¯ä¸ªå…ƒç´ å ç”¨ m/n ä¸ªæ¯”ç‰¹ï¼Œæœ€ä¼˜æƒ…å†µä¸‹ï¼Œè¿™äº›æ¯”ç‰¹ä¸­å¤§çº¦æœ‰ä¸€åŠåº”è¯¥æ˜¯1ï¼ˆè¿™å°±æ˜¯ln(2)çš„æ¥æºï¼‰ï¼Œå“ˆå¸Œå‡½æ•°æ•°é‡kå†³å®šäº†"åˆ†æ•£ç¨‹åº¦"
    ğŸŸ¢ create å·¥å‚æ–¹æ³•çš„å·¨å¤§ä»·å€¼ï¼šä»…å®ç°äº†å¸ƒéš†è¿‡æ»¤å™¨ï¼Œè¿˜å®ç°äº†ä¸€ä¸ªæ™ºèƒ½çš„ã€è‡ªé…ç½®çš„å¸ƒéš†è¿‡æ»¤å™¨å·¥å‚
    ç”¨æˆ·ä½“éªŒæä½³ï¼šç”¨æˆ·ä¸éœ€è¦ç†è§£å¸ƒéš†è¿‡æ»¤å™¨çš„æ•°å­¦ç»†èŠ‚
    æ€§èƒ½æœ€ä¼˜åŒ–ï¼šè‡ªåŠ¨æ‰¾åˆ°ç©ºé—´å’Œå‡†ç¡®æ€§çš„æœ€ä½³å¹³è¡¡ç‚¹
    é¿å…é…ç½®é”™è¯¯ï¼šé˜²æ­¢å› å‚æ•°è®¾ç½®ä¸å½“å¯¼è‡´çš„ç³»ç»Ÿæ•…éšœ
    å¯ç»´æŠ¤æ€§ï¼šå¦‚æœæ•°å­¦å…¬å¼æœ‰æ”¹è¿›ï¼Œåªéœ€è¦ä¿®æ”¹è¿™ä¸€ä¸ªåœ°æ–¹
    */
  }

  // åºåˆ—åŒ–ï¼šå°†çŠ¶æ€è½¬æ¢ä¸ºå¯å­˜å‚¨çš„JSON
  serialize() {
    return {
      size: this.size,
      hashFunctions: this.hashFunctions,
      // å°† Uint8Array è½¬æ¢ä¸ºæ™®é€šæ•°ç»„ä»¥ä¾¿ JSON åºåˆ—åŒ–
      bitArray: Array.from(this.bitArray)
    };
    /*
    ğŸŸ¢å…³é”®çš„å·¥ç¨‹é—®é¢˜ï¼šå¦‚ä½•å°†å†…å­˜ä¸­çš„å¸ƒéš†è¿‡æ»¤å™¨ä¿å­˜ä¸‹æ¥ï¼Œä»¥ä¾¿ä¸‹æ¬¡å¯åŠ¨æ—¶è¿˜èƒ½ç»§ç»­ä½¿ç”¨ï¼›é—®é¢˜ï¼šå†…å­˜çš„è„†å¼±æ€§ï¼›
    æˆ‘ä»¬çš„å¸ƒéš†è¿‡æ»¤å™¨æ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼šthis.bitArray = new Uint8Array([0, 255, 128, 64, ...]);
    ä½†æ˜¯ï¼šç¨‹åºé‡å¯ â†’ å†…å­˜æ¸…ç©º,æœåŠ¡å™¨å´©æºƒ â†’ æ•°æ®ä¸¢å¤±,éœ€è¦è¿ç§»åˆ°å¦ä¸€å°æœºå™¨ â†’ æ— æ³•ä¼ è¾“
    æ²¡æœ‰åºåˆ—åŒ–çš„è¯ï¼šæ¯æ¬¡é‡å¯éƒ½è¦ä»å¤´å¼€å§‹é‡å»ºè¿‡æ»¤å™¨ï¼Œå¯¹äºçˆ¬è™«è¿™ç±»åº”ç”¨æ¥è¯´æ˜¯ä¸å¯æ¥å—çš„ï¼åºåˆ—åŒ–ï¼šæŠŠå†…å­˜å¯¹è±¡å˜æˆå¯å­˜å‚¨çš„æ•°æ®
    ğŸŸ¢Array.from(this.bitArray)è§£å†³æ–¹æ¡ˆï¼š è½¬æ¢æˆæ™®é€šæ•°ç»„
    é—®é¢˜ï¼š Uint8Array ä¸èƒ½ç›´æ¥ JSON åºåˆ—åŒ–ç»“æœæ˜¯ "{}" æ•°æ®ä¸¢å¤±ï¼
    const normalArray = Array.from(uintArray); // [1, 2, 3]
    JSON.stringify(normalArray); // ç»“æœæ˜¯ "[1,2,3]" âœ…
    ğŸŸ¢åºåˆ—åŒ–çš„å®Œæ•´æµç¨‹:
    å‡è®¾æˆ‘ä»¬çš„è¿‡æ»¤å™¨çŠ¶æ€ï¼š
    å†…å­˜ä¸­çš„çŠ¶æ€:                        è°ƒç”¨ serialize() å            const savedData = bloomFilter.serialize();
    this.size = 100;                                                 savedData çš„å€¼ï¼š {
    this.hashFunctions = 3;                                              size: 100,
    this.bitArray = new Uint8Array([255, 0, 128]);                       hashFunctions: 3,             
    //äºŒè¿›åˆ¶: [11111111, 00000000, 10000000]                              bitArray: [255, 0, 128]   }    
                                                                      // ä» Uint8Arrayè½¬æˆäº†æ™®é€šæ•°ç»„ç°åœ¨å¯ä»¥å®‰å…¨å­˜å‚¨äº†ï¼š
                                                                      // ä¿å­˜åˆ°æ–‡ä»¶
                                                                      fs.writeFileSync('filter-state.json', JSON.stringify(savedData));
                                                                      // æˆ–è€…ä¿å­˜åˆ°æ•°æ®åº“
                                                                      db.save('bloom_filter', JSON.stringify(savedData));
                                                                      // æˆ–è€…é€šè¿‡ç½‘ç»œå‘é€
                                                                      websocket.send(JSON.stringify(savedData));
    serialize() æ–¹æ³•è®©å¸ƒéš†è¿‡æ»¤å™¨ä»ä¸´æ—¶çš„å·¥ä½œè®°å¿†å‡çº§ä¸ºæ°¸ä¹…çš„æŒä¹…åŒ–å­˜å‚¨,æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„å·¥ç¨‹ç»„ä»¶
    å®ƒè§£å†³äº†ç”Ÿäº§ç¯å¢ƒä¸­æœ€å…³é”®çš„é—®é¢˜ä¹‹ä¸€ï¼šçŠ¶æ€æŒä¹…åŒ–ã€‚æ²¡æœ‰å®ƒï¼Œå¸ƒéš†è¿‡æ»¤å™¨åªèƒ½ç”¨äºä¸´æ—¶ä»»åŠ¡ï¼›æœ‰äº†å®ƒï¼Œå¸ƒéš†è¿‡æ»¤å™¨å°±å¯ä»¥ç”¨äºéœ€è¦é•¿æœŸè¿è¡Œçš„é‡è¦ç³»ç»Ÿ
    ğŸŸ¢é…å¥—çš„ååºåˆ—åŒ–æ–¹æ³•:å…‰æœ‰åºåˆ—åŒ–è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦èƒ½è¿˜åŸå›æ¥ï¼š
      å®é™…åº”ç”¨åœºæ™¯:åœºæ™¯1ï¼šçˆ¬è™«æŒä¹…åŒ–,åœºæ™¯2ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿ,åœºæ™¯3ï¼šæµè§ˆå™¨åº”ç”¨
    ğŸŸ¢è¿™æ ·è®¾è®¡:
    å…¼å®¹æ€§ï¼šä½¿ç”¨æ ‡å‡†JSONæ ¼å¼ï¼Œä»»ä½•ç³»ç»Ÿéƒ½èƒ½å¤„ç†
    å®Œæ•´æ€§ï¼šä¿å­˜äº†é‡å»ºè¿‡æ»¤å™¨æ‰€éœ€çš„æ‰€æœ‰å‚æ•°ï¼ˆsize, hashFunctions, bitArrayï¼‰
    æ•ˆç‡ï¼šåªä¿å­˜å¿…è¦æ•°æ®ï¼Œæ²¡æœ‰å†—ä½™ä¿¡æ¯
    å¯è°ƒè¯•ï¼šåºåˆ—åŒ–åçš„JSONäººç±»å¯è¯»ï¼Œä¾¿äºè°ƒè¯•
    */
  }

  // ååºåˆ—åŒ–ï¼šä»JSONæ•°æ®é‡å»ºè¿‡æ»¤å™¨
  static deserialize(data) {
    const filter = new BloomFilter(data.size, data.hashFunctions);
    // å°†æ™®é€šæ•°ç»„è½¬å› Uint8Array
    filter.bitArray = new Uint8Array(data.bitArray);
    return filter;
  }
  /*---------âš ï¸æ³¨æ„---------/
  ğŸ› ï¸Uncaught ReferenceError: require is not definedï¼šå°†requireæ”¹æˆimport
  ğŸŸ¢package.json æ–‡ä»¶ï¼šNode.jsé¡¹ç›®çš„èº«ä»½è¯å’Œé…ç½®ä¸­å¿ƒï¼›
  npm init -y  # åˆ›å»º package.json 
  ä¾èµ–åº“æ¸…å•ï¼Œé¡¹ç›®åç§°ï¼Œç‰ˆæœ¬å·ï¼Œé¡¹ç›®æè¿°ï¼Œå…¥å£æ–‡ä»¶ï¼Œå¼€å‘ä¾èµ–ï¼Œå¿«æ·å‘½ä»¤ï¼Œå…³é”®è¯ï¼Œä½œè€…ä¿¡æ¯ï¼Œå¼€æºè®¸å¯è¯ISCæ˜¯ä¸€ç§ç®€å•çš„å¼€æºåè®®
  package.json æ–‡ä»¶å°±æ˜¯ä½ çš„é¡¹ç›®ä»"ä¸€æ®µè„šæœ¬"å‡çº§ä¸º"ä¸€ä¸ªå·¥ç¨‹åŒ–é¡¹ç›®"çš„æ ‡å¿—
  å…³é”®æ”¹è¿›è¯´æ˜:
    "type": "module"ï¼šå¯ç”¨ ES6 æ¨¡å—ï¼Œè¿™æ ·å°±èƒ½ç”¨ import/export äº†
    "main": "src/bloom-filter.js"ï¼šæŒ‡å®šæ­£ç¡®çš„å…¥å£æ–‡ä»¶
    æ·»åŠ äº†æœ‰ç”¨çš„ scriptsï¼š
        npm run devï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨
        npm run buildï¼šæ„å»ºç”Ÿäº§ç‰ˆæœ¬
        npm testï¼šè¿è¡Œæµ‹è¯•
    æ·»åŠ äº†å¼€å‘ä¾èµ–ï¼švite ç”¨äºç°ä»£å‰ç«¯å¼€å‘
    å®Œå–„äº†æè¿°ä¿¡æ¯ï¼šè®©äººä¸€çœ¼å°±çŸ¥é“é¡¹ç›®æ˜¯åšä»€ä¹ˆçš„
  ğŸŸ¢å®Œæ•´çš„é¡¹ç›®åˆå§‹åŒ–æ­¥éª¤ï¼šViteçš„é­”æ³•ï¼šæŒ‰éœ€ç¼–è¯‘;å‡ ä¹æ— æ„ŸçŸ¥æ›´æ–°
  1.é¦–å…ˆå®‰è£… Viteï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰ï¼šnpm install -D vite
  2.å®‰è£… murmurhashï¼šnpm install murmurhash-js
  3.åˆ›å»ºå¿…è¦çš„æ–‡ä»¶ï¼švite.config.jsï¼šindex.htmlï¼šsrc/main.jsï¼šsrc/bloom-filter.jsï¼š
  4.è¿è¡Œé¡¹ç›®ï¼šnpm run devç„¶åè®¿é—® http://localhost:number å°±èƒ½çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºçš„æµ‹è¯•ç»“æœ
  ğŸŸ¢æ­å»ºä¸€ä¸ªå®Œæ•´çš„ç°ä»£å‰ç«¯å¼€å‘ç¯å¢ƒ:æµ‹è¯•æ‰€æœ‰é«˜çº§åŠŸèƒ½,æŸ¥çœ‹å®æ—¶ç»Ÿè®¡ä¿¡æ¯,ä½“éªŒåºåˆ—åŒ–/ååºåˆ—åŒ–,è§‚å¯Ÿè¯¯æŠ¥ç‡å˜åŒ–
  ç¼–ç é—®é¢˜:
  # æ£€æŸ¥æ–‡ä»¶ç¼–ç ï¼ˆæ­£ç¡®çš„å‚æ•°ï¼‰file -i index.html
  # æ£€æŸ¥æ–‡ä»¶å†…å®¹cat index.html
  # æ£€æŸ¥ç›®å½•ç»“æ„ls -la
  # æ£€æŸ¥ Vite æ˜¯å¦åœ¨è¿è¡Œps aux | grep vite
  # æ£€æŸ¥ç«¯å£å ç”¨netstat -tulpn | grep number
  ğŸŸ¢CDN = Content Delivery Network = å†…å®¹åˆ†å‘ç½‘ç»œ
  è¦ä½“éªŒçœŸæ­£çš„CDNéœ€è¦ï¼š1.æŠŠé¡¹ç›®éƒ¨ç½²åˆ°ç½‘ä¸Šï¼ˆVercel/Netlifyï¼‰2.è®©ä¸åŒåœ°æ–¹çš„äººç±»è®¿é—® 3.æ„Ÿå—å„åœ°éƒ½å¾ˆå¿«çš„ç¥å¥‡æ•ˆæœ
  å»ºè®®ä½¿ç”¨vite
  */
}
```
```
//å¸ƒéš†è¿‡æ»¤å™¨å·¥ç¨‹ç‰ˆ - æ§åˆ¶å°ç»ˆææµ‹è¯•ç‰ˆ
console.log(' å¯åŠ¨å¸ƒéš†è¿‡æ»¤å™¨ç»ˆææµ‹è¯•...\n');

class BloomFilter {
    constructor(size, hashFunctions) {
        this.byteCount = Math.ceil(size / 8);
        this.bitArray = new Uint8Array(this.byteCount);
        this.hashFunctions = hashFunctions;
        this.size = size;
        console.log(` åˆ›å»ºè¿‡æ»¤å™¨: ${size}ä½, ${hashFunctions}ä¸ªå“ˆå¸Œå‡½æ•°`);
    }

    // ä¼˜åŒ–çš„å“ˆå¸Œå‡½æ•°ï¼ˆæ§åˆ¶å°ä¸“ç”¨ï¼‰
    _hashFunction(seed) {
        return (str) => {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = (hash * 31 + str.charCodeAt(i) * (seed + 1)) % this.size;
            }
            return Math.abs(hash);
        };
    }

    _setBit(position) {
        const byteIndex = Math.floor(position / 8);
        const bitIndex = position % 8;
        this.bitArray[byteIndex] |= (1 << bitIndex);
    }

    _getBit(position) {
        const byteIndex = Math.floor(position / 8);
        const bitIndex = position % 8;
        return (this.bitArray[byteIndex] & (1 << bitIndex)) !== 0;
    }

    add(item) {
        for (let i = 0; i < this.hashFunctions; i++) {
            const hashFunc = this._hashFunction(i);
            const position = hashFunc(item);
            this._setBit(position);
        }
        console.log(`âœ… æ·»åŠ : "${item}"`);
        return this;
    }

    contains(item) {
        for (let i = 0; i < this.hashFunctions; i++) {
            const hashFunc = this._hashFunction(i);
            const position = hashFunc(item);
            if (!this._getBit(position)) {
                return false;
            }
        }
        return true;
    }

    check(item) {
        const result = this.contains(item);
        console.log(`ğŸ” æ£€æŸ¥ "${item}": ${result ? 'âš ï¸ å¯èƒ½å­˜åœ¨' : 'âŒ è‚¯å®šä¸å­˜åœ¨'}`);
        return result;
    }

    // ç»Ÿè®¡ä¿¡æ¯
    getStats() {
        let setBits = 0;
        for (let i = 0; i < this.byteCount; i++) {
            let byte = this.bitArray[i];
            while (byte) {
                setBits += byte & 1;
                byte >>= 1;
            }
        }
        
        const stats = {
            size: this.size,
            hashFunctions: this.hashFunctions,
            byteCount: this.byteCount,
            setBits: setBits,
            setBitRatio: (setBits / this.size * 100).toFixed(2) + '%',
            estimatedFalsePositiveRate: (Math.pow(setBits / this.size, this.hashFunctions) * 100).toFixed(4) + '%'
        };
        
        console.log('ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:', stats);
        return stats;
    }

    // å·¥å‚æ–¹æ³•
    static create(expectedItems, falsePositiveRate) {
        const n = expectedItems;
        const p = falsePositiveRate;
        const m = Math.ceil(-(n * Math.log(p)) / (Math.LN2 ** 2));
        const k = Math.max(1, Math.round((m / n) * Math.LN2));
        
        console.log(`ğŸ­ æ™ºèƒ½åˆ›å»º: é¢„æœŸ${n}å…ƒç´ , ${p*100}%è¯¯æŠ¥ç‡ â†’ ${m}ä½, ${k}ä¸ªå“ˆå¸Œå‡½æ•°`);
        return new BloomFilter(m, k);
    }
}

//å¼€å§‹æµ‹è¯•ï¼
console.log('å¸ƒéš†è¿‡æ»¤å™¨æµ‹è¯•å¼€å§‹...\n');

// åˆ›å»ºæ™ºèƒ½è¿‡æ»¤å™¨
const bloom = BloomFilter.create(100, 0.01);

// 1ï¼šåŸºæœ¬åŠŸèƒ½
console.log('\nåŸºç¡€åŠŸèƒ½1: å­˜å‚¨');
bloom.add('https://example.com/page1')
     .add('https://example.com/page2')
     .add('https://example.com/page3');

bloom.check('https://example.com/page1');  // âœ… å­˜åœ¨
bloom.check('https://example.com/page99'); // âŒ ä¸å­˜åœ¨

// 2ï¼šå†…å­˜æ•ˆç‡
console.log('\n æµ‹è¯•2: å†…å­˜é­”æœ¯');
for (let i = 0; i < 50; i++) {
    bloom.add(`website-${i}`);
}
const stats = bloom.getStats();
console.log(` å­˜å‚¨äº†50ä¸ªç½‘å€ï¼Œåªç”¨ ${stats.byteCount} å­—èŠ‚å†…å­˜ï¼`);

// 3ï¼šè¯¯æŠ¥ç‡æµ‹è¯•
console.log('\n æ¼”ç¤º3: è¯¯æŠ¥ç‡æµ‹è¯•');
let falseCount = 0;
for (let i = 0; i < 200; i++) {
    if (bloom.check(`random-test-${i}`)) {
        falseCount++;
    }
}
console.log(` å®é™…è¯¯æŠ¥: ${falseCount}/200 (${(falseCount/200*100).toFixed(1)}%)`);

console.log('\n æµ‹è¯•ç»“æŸï¼');

// åˆ›å»ºå…¨å±€å˜é‡æ–¹ä¾¿æµ‹è¯•
window.bloom = bloom;
console.log('ğŸ”§ æç¤º: å·²åˆ›å»ºå…¨å±€å˜é‡ "bloom" ä¾›ä½ æµ‹è¯•');
```
